{"decls":[{"kind":"export","names":["ext.httparse.body","ext.httparse.err_code","ext.httparse.header_count","ext.httparse.header_get","ext.httparse.header_name","ext.httparse.header_value","ext.httparse.is_err","ext.httparse.kind","ext.httparse.method","ext.httparse.parse_request","ext.httparse.parse_response","ext.httparse.reason","ext.httparse.status_code","ext.httparse.target","ext.httparse.version"]},{"body":["if",["ext.httparse._is_upper_ascii","c"],["+","c",32],"c"],"kind":"defn","name":"ext.httparse._ascii_lower","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","needle"]],["if",["=",["=","msg_len","n"],0],["return",0],0],["for","i",0,"msg_len",["begin",["let","a",["ext.httparse._ascii_lower",["view.get_u8","msg",["+","msg_start","i"]]]],["let","b",["ext.httparse._ascii_lower",["view.get_u8","needle","i"]]],["if",["=",["=","a","b"],0],["return",0],0]]],1],"kind":"defn","name":"ext.httparse._eq_ascii_case_insensitive","params":[{"name":"msg","ty":"bytes_view"},{"name":"msg_start","ty":"i32"},{"name":"msg_len","ty":"i32"},{"name":"needle","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["for","i","start","end",["if",["=",["view.get_u8","b","i"],"needle"],["return","i"],0]],["-",0,1]],"kind":"defn","name":"ext.httparse._find_byte","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"},{"name":"needle","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["if",[">=u",["+","start",1],"n"],["return",["-",0,1]],0],["for","i","start",["-","n",1],["if",["=",["view.get_u8","b","i"],13],["if",["=",["view.get_u8","b",["+","i",1]],10],["return","i"],0],0]],["-",0,1]],"kind":"defn","name":"ext.httparse._find_crlf","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"i32"},{"body":["begin",["let","count",["ext.httparse.header_count","doc"]],["if",["if",["<","idx",0],1,[">=","idx","count"]],["return",0],0],["let","base",["+",["+",44,["*","idx",16]],["*","field",4]]],["ext.httparse._u32_field_or_0","doc","base"]],"kind":"defn","name":"ext.httparse._header_entry_field","params":[{"name":"doc","ty":"bytes_view"},{"name":"idx","ty":"i32"},{"name":"field","ty":"i32"}],"result":"i32"},{"body":["if",["=","c",32],1,["=","c",9]],"kind":"defn","name":"ext.httparse._is_ows","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["if",[">=u","c",65],["<u","c",91],0],"kind":"defn","name":"ext.httparse._is_upper_ascii","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["let","out",["vec_u8.with_capacity",9]],["set","out",["vec_u8.push","out",0]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","code"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",0]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.httparse._make_err","params":[{"name":"code","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","headers_len",["bytes.len","headers_bytes"]],["let","out",["vec_u8.with_capacity",["+",52,"headers_len"]]],["set","out",["vec_u8.push","out",1]],["set","out",["vec_u8.push","out","kind"]],["set","out",["vec_u8.push","out",0]],["set","out",["vec_u8.push","out",0]],["set","out",["ext.httparse._push_u32_le","out","version_start"]],["set","out",["ext.httparse._push_u32_le","out","version_len"]],["set","out",["ext.httparse._push_u32_le","out","method_start"]],["set","out",["ext.httparse._push_u32_le","out","method_len"]],["set","out",["ext.httparse._push_u32_le","out","target_start"]],["set","out",["ext.httparse._push_u32_le","out","target_len"]],["set","out",["ext.httparse._push_u32_le","out","status_code"]],["set","out",["ext.httparse._push_u32_le","out","reason_start"]],["set","out",["ext.httparse._push_u32_le","out","reason_len"]],["set","out",["ext.httparse._push_u32_le","out","header_count"]],["set","out",["vec_u8.extend_bytes","out",["bytes.view","headers_bytes"]]],["set","out",["ext.httparse._push_u32_le","out","body_start"]],["set","out",["ext.httparse._push_u32_le","out","body_len"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.httparse._ok_doc","params":[{"name":"kind","ty":"i32"},{"name":"version_start","ty":"i32"},{"name":"version_len","ty":"i32"},{"name":"method_start","ty":"i32"},{"name":"method_len","ty":"i32"},{"name":"target_start","ty":"i32"},{"name":"target_len","ty":"i32"},{"name":"status_code","ty":"i32"},{"name":"reason_start","ty":"i32"},{"name":"reason_len","ty":"i32"},{"name":"header_count","ty":"i32"},{"name":"headers_bytes","ty":"bytes"},{"name":"body_start","ty":"i32"},{"name":"body_len","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","msg"]],["let","entries",["vec_u8.with_capacity",0]],["let","count",0],["let","pos","start"],["let","done",0],["for","_",0,["+","n",1],["if","done",0,["if",[">=u",["+","pos",1],"n"],["return",["ext.httparse._make_err",1]],["if",["if",["=",["view.get_u8","msg","pos"],13],["=",["view.get_u8","msg",["+","pos",1]],10],0],["begin",["set","done",1],0],["begin",["let","line_end",["ext.httparse._find_crlf","msg","pos"]],["if",["<","line_end",0],["return",["ext.httparse._make_err",1]],0],["let","colon",["ext.httparse._find_byte","msg","pos","line_end",58]],["if",["<=","colon","pos"],["return",["ext.httparse._make_err",3]],0],["let","name_start","pos"],["let","name_len",["-","colon","pos"]],["let","value_start",["+","colon",1]],["set","value_start",["ext.httparse._skip_ows","msg","value_start","line_end"]],["let","value_end",["ext.httparse._trim_end_ows","msg","value_start","line_end"]],["let","value_len",["if",[">","value_end","value_start"],["-","value_end","value_start"],0]],["set","entries",["ext.httparse._push_u32_le","entries","name_start"]],["set","entries",["ext.httparse._push_u32_le","entries","name_len"]],["set","entries",["ext.httparse._push_u32_le","entries","value_start"]],["set","entries",["ext.httparse._push_u32_le","entries","value_len"]],["set","count",["+","count",1]],["set","pos",["+","line_end",2]]]]]]],["let","entries_b",["vec_u8.into_bytes","entries"]],["let","entries_v",["bytes.view","entries_b"]],["let","entries_len",["view.len","entries_v"]],["let","out",["vec_u8.with_capacity",["+",["+",1,4],"entries_len"]]],["set","out",["vec_u8.push","out",1]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","count"]]],["set","out",["vec_u8.extend_bytes","out","entries_v"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.httparse._parse_headers","params":[{"name":"msg","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"bytes"},{"body":["vec_u8.extend_bytes","out",["codec.write_u32_le","x"]],"kind":"defn","name":"ext.httparse._push_u32_le","params":[{"name":"out","ty":"vec_u8"},{"name":"x","ty":"i32"}],"result":"vec_u8"},{"body":["begin",["let","b0",["view.get_u8","b","off"]],["let","b1",["view.get_u8","b",["+","off",1]]],["let","b2",["view.get_u8","b",["+","off",2]]],["let","b3",["view.get_u8","b",["+","off",3]]],["+",["+",["+","b0",["<<u","b1",8]],["<<u","b2",16]],["<<u","b3",24]]],"kind":"defn","name":"ext.httparse._read_u32_le_view","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["begin",["for","i","start","end",["if",["=",["ext.httparse._is_ows",["view.get_u8","b","i"]],0],["return","i"],0]],"end"],"kind":"defn","name":"ext.httparse._skip_ows","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"}],"result":"i32"},{"body":["begin",["if",["<=","end","start"],["return","end"],0],["let","r","end"],["let","i",["-","end",1]],["let","done",0],["for","_","start","end",["if",["=","done",0],["if",["<","i","start"],["set","done",1],["begin",["let","c",["view.get_u8","b","i"]],["if",["ext.httparse._is_ows","c"],["begin",["set","r","i"],["set","i",["-","i",1]]],["set","done",1]]]],0]],"r"],"kind":"defn","name":"ext.httparse._trim_end_ows","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"}],"result":"i32"},{"body":["if",["<u",["view.len","doc"],["+","off",4]],0,["codec.read_u32_le","doc","off"]],"kind":"defn","name":"ext.httparse._u32_field_or_0","params":[{"name":"doc","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["begin",["if",["=",["ext.httparse.kind","doc"],0],["return",["bytes.alloc",0]],0],["let","count",["ext.httparse.header_count","doc"]],["let","base",["+",44,["*","count",16]]],["let","start",["ext.httparse._u32_field_or_0","doc","base"]],["let","len",["ext.httparse._u32_field_or_0","doc",["+","base",4]]],["view.to_bytes",["view.slice","msg","start","len"]]],"kind":"defn","name":"ext.httparse.body","params":[{"name":"doc","ty":"bytes_view"},{"name":"msg","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["<",["view.len","doc"],5],["return",0],0],["if",["=",["=",["view.get_u8","doc",0],0],0],["return",0],0],["codec.read_u32_le","doc",1]],"kind":"defn","name":"ext.httparse.err_code","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["ext.httparse.kind","doc"],0],["return",0],0],["ext.httparse._u32_field_or_0","doc",40]],"kind":"defn","name":"ext.httparse.header_count","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["ext.httparse.kind","doc"],0],["return",["bytes.alloc",0]],0],["let","count",["ext.httparse.header_count","doc"]],["for","i",0,"count",["begin",["let","n_start",["ext.httparse._header_entry_field","doc","i",0]],["let","n_len",["ext.httparse._header_entry_field","doc","i",1]],["if",["ext.httparse._eq_ascii_case_insensitive","msg","n_start","n_len","name"],["begin",["let","v_start",["ext.httparse._header_entry_field","doc","i",2]],["let","v_len",["ext.httparse._header_entry_field","doc","i",3]],["return",["view.to_bytes",["view.slice","msg","v_start","v_len"]]]],0]]],["bytes.alloc",0]],"kind":"defn","name":"ext.httparse.header_get","params":[{"name":"doc","ty":"bytes_view"},{"name":"msg","ty":"bytes_view"},{"name":"name","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["=",["ext.httparse.kind","doc"],0],["return",["bytes.alloc",0]],0],["let","start",["ext.httparse._header_entry_field","doc","idx",0]],["let","len",["ext.httparse._header_entry_field","doc","idx",1]],["view.to_bytes",["view.slice","msg","start","len"]]],"kind":"defn","name":"ext.httparse.header_name","params":[{"name":"doc","ty":"bytes_view"},{"name":"msg","ty":"bytes_view"},{"name":"idx","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["=",["ext.httparse.kind","doc"],0],["return",["bytes.alloc",0]],0],["let","start",["ext.httparse._header_entry_field","doc","idx",2]],["let","len",["ext.httparse._header_entry_field","doc","idx",3]],["view.to_bytes",["view.slice","msg","start","len"]]],"kind":"defn","name":"ext.httparse.header_value","params":[{"name":"doc","ty":"bytes_view"},{"name":"msg","ty":"bytes_view"},{"name":"idx","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["<",["view.len","doc"],1],["return",1],0],["=",["view.get_u8","doc",0],0]],"kind":"defn","name":"ext.httparse.is_err","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["<",["view.len","doc"],2],["return",0],0],["if",["=",["=",["view.get_u8","doc",0],1],0],["return",0],0],["view.get_u8","doc",1]],"kind":"defn","name":"ext.httparse.kind","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["=",["ext.httparse.kind","doc"],1],0],["return",["bytes.alloc",0]],0],["let","start",["ext.httparse._u32_field_or_0","doc",12]],["let","len",["ext.httparse._u32_field_or_0","doc",16]],["view.to_bytes",["view.slice","msg","start","len"]]],"kind":"defn","name":"ext.httparse.method","params":[{"name":"doc","ty":"bytes_view"},{"name":"msg","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","msg"]],["let","line_end",["ext.httparse._find_crlf","msg",0]],["if",["<","line_end",0],["return",["ext.httparse._make_err",1]],0],["let","method_end",["ext.httparse._find_byte","msg",0,"line_end",32]],["if",["<=","method_end",0],["return",["ext.httparse._make_err",2]],0],["let","method_start",0],["let","method_len",["-","method_end","method_start"]],["let","target_start",["ext.httparse._skip_ows","msg",["+","method_end",1],"line_end"]],["let","target_end",["ext.httparse._find_byte","msg","target_start","line_end",32]],["if",["<=","target_end","target_start"],["return",["ext.httparse._make_err",2]],0],["let","target_len",["-","target_end","target_start"]],["let","version_start",["ext.httparse._skip_ows","msg",["+","target_end",1],"line_end"]],["if",[">=u","version_start","line_end"],["return",["ext.httparse._make_err",2]],0],["let","version_end",["ext.httparse._trim_end_ows","msg","version_start","line_end"]],["let","version_len",["if",[">","version_end","version_start"],["-","version_end","version_start"],0]],["let","headers_start",["+","line_end",2]],["let","headers_doc_b",["ext.httparse._parse_headers","msg","headers_start"]],["let","headers_doc_len",["bytes.len","headers_doc_b"]],["if",["<u","headers_doc_len",1],["return",["ext.httparse._make_err",1]],0],["if",["=",["bytes.get_u8","headers_doc_b",0],0],["return","headers_doc_b"],0],["if",["<u","headers_doc_len",5],["return",["ext.httparse._make_err",1]],0],["let","header_count",["ext.httparse._read_u32_le_view",["bytes.view","headers_doc_b"],1]],["let","pos","headers_start"],["let","body_start",0],["let","done",0],["for","_",0,["+","n",1],["if","done",0,["if",[">=u",["+","pos",1],"n"],["return",["ext.httparse._make_err",1]],["if",["if",["=",["view.get_u8","msg","pos"],13],["=",["view.get_u8","msg",["+","pos",1]],10],0],["begin",["set","body_start",["+","pos",2]],["set","done",1],0],["begin",["let","e",["ext.httparse._find_crlf","msg","pos"]],["if",["<","e",0],["return",["ext.httparse._make_err",1]],0],["set","pos",["+","e",2]]]]]]],["if",["=","done",0],["return",["ext.httparse._make_err",1]],0],["let","body_len",["if",["<=","body_start","n"],["-","n","body_start"],0]],["let","headers_payload_b",["bytes.slice","headers_doc_b",5,["-","headers_doc_len",5]]],["ext.httparse._ok_doc",1,"version_start","version_len","method_start","method_len","target_start","target_len",0,0,0,"header_count","headers_payload_b","body_start","body_len"]],"kind":"defn","name":"ext.httparse.parse_request","params":[{"name":"msg","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","msg"]],["let","line_end",["ext.httparse._find_crlf","msg",0]],["if",["<","line_end",0],["return",["ext.httparse._make_err",1]],0],["let","version_end",["ext.httparse._find_byte","msg",0,"line_end",32]],["if",["<=","version_end",0],["return",["ext.httparse._make_err",2]],0],["let","version_start",0],["let","version_len",["-","version_end","version_start"]],["let","status_start",["ext.httparse._skip_ows","msg",["+","version_end",1],"line_end"]],["if",[">=u","status_start","line_end"],["return",["ext.httparse._make_err",2]],0],["let","status_end0",["ext.httparse._find_byte","msg","status_start","line_end",32]],["let","status_end",["if",["<","status_end0",0],"line_end","status_end0"]],["if",["<=","status_end","status_start"],["return",["ext.httparse._make_err",4]],0],["let","status",0],["for","i","status_start","status_end",["begin",["let","c",["view.get_u8","msg","i"]],["if",["=",["if",[">=u","c",48],["<u","c",58],0],0],["return",["ext.httparse._make_err",4]],0],["set","status",["+",["*","status",10],["-","c",48]]]]],["let","reason_start","status_end"],["if",["<","reason_start","line_end"],["set","reason_start",["ext.httparse._skip_ows","msg",["+","status_end",1],"line_end"]],0],["let","reason_end",["ext.httparse._trim_end_ows","msg","reason_start","line_end"]],["let","reason_len",["if",[">","reason_end","reason_start"],["-","reason_end","reason_start"],0]],["let","headers_start",["+","line_end",2]],["let","headers_doc_b",["ext.httparse._parse_headers","msg","headers_start"]],["let","headers_doc_len",["bytes.len","headers_doc_b"]],["if",["<u","headers_doc_len",1],["return",["ext.httparse._make_err",1]],0],["if",["=",["bytes.get_u8","headers_doc_b",0],0],["return","headers_doc_b"],0],["if",["<u","headers_doc_len",5],["return",["ext.httparse._make_err",1]],0],["let","header_count",["ext.httparse._read_u32_le_view",["bytes.view","headers_doc_b"],1]],["let","pos","headers_start"],["let","body_start",0],["let","done",0],["for","_",0,["+","n",1],["if","done",0,["if",[">=u",["+","pos",1],"n"],["return",["ext.httparse._make_err",1]],["if",["if",["=",["view.get_u8","msg","pos"],13],["=",["view.get_u8","msg",["+","pos",1]],10],0],["begin",["set","body_start",["+","pos",2]],["set","done",1],0],["begin",["let","e",["ext.httparse._find_crlf","msg","pos"]],["if",["<","e",0],["return",["ext.httparse._make_err",1]],0],["set","pos",["+","e",2]]]]]]],["if",["=","done",0],["return",["ext.httparse._make_err",1]],0],["let","body_len",["if",["<=","body_start","n"],["-","n","body_start"],0]],["let","headers_payload_b",["bytes.slice","headers_doc_b",5,["-","headers_doc_len",5]]],["ext.httparse._ok_doc",2,"version_start","version_len",0,0,0,0,"status","reason_start","reason_len","header_count","headers_payload_b","body_start","body_len"]],"kind":"defn","name":"ext.httparse.parse_response","params":[{"name":"msg","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["=",["=",["ext.httparse.kind","doc"],2],0],["return",["bytes.alloc",0]],0],["let","start",["ext.httparse._u32_field_or_0","doc",32]],["let","len",["ext.httparse._u32_field_or_0","doc",36]],["view.to_bytes",["view.slice","msg","start","len"]]],"kind":"defn","name":"ext.httparse.reason","params":[{"name":"doc","ty":"bytes_view"},{"name":"msg","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["=",["=",["ext.httparse.kind","doc"],2],0],["return",0],0],["ext.httparse._u32_field_or_0","doc",28]],"kind":"defn","name":"ext.httparse.status_code","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["=",["ext.httparse.kind","doc"],1],0],["return",["bytes.alloc",0]],0],["let","start",["ext.httparse._u32_field_or_0","doc",20]],["let","len",["ext.httparse._u32_field_or_0","doc",24]],["view.to_bytes",["view.slice","msg","start","len"]]],"kind":"defn","name":"ext.httparse.target","params":[{"name":"doc","ty":"bytes_view"},{"name":"msg","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["=",["ext.httparse.kind","doc"],0],["return",["bytes.alloc",0]],0],["let","start",["ext.httparse._u32_field_or_0","doc",4]],["let","len",["ext.httparse._u32_field_or_0","doc",8]],["view.to_bytes",["view.slice","msg","start","len"]]],"kind":"defn","name":"ext.httparse.version","params":[{"name":"doc","ty":"bytes_view"},{"name":"msg","ty":"bytes_view"}],"result":"bytes"}],"imports":[],"kind":"module","meta":{"generated_by":"x07import","source_path":"tests/x07import/fixtures/import_sources/rust/ext_url@0.1.0/httparse.rs","source_sha256":"3e6bb3c2ad7bb0ccc927c309635429a841ff412cabea9c6129fc36cd20783fa8"},"module_id":"ext.httparse","schema_version":"x07.x07ast@0.3.0"}
