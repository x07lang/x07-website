{
  "schema_version": "x07.x07ast@0.3.0",
  "kind": "module",
  "module_id": "ext.url.tests",
  "imports": ["std.test", "ext.url.parse", "ext.url.encode"],
  "decls": [
    {
      "kind": "export",
      "names": [
        "ext.url.tests.test_parse_full_url",
        "ext.url.tests.test_percent_encode_roundtrip"
      ]
    },
    {
      "kind": "defn",
      "name": "ext.url.tests.test_parse_full_url",
      "params": [],
      "result": "result_i32",
      "body": ["begin",
        ["let", "url", ["bytes.lit", "https://example.com:8080/path?query=1#frag"]],
        ["let", "url_view", ["bytes.view", "url"]],
        ["let", "parsed", ["ext.url.parse.url_parse", "url_view"]],
        ["let", "parsed_view", ["bytes.view", "parsed"]],
        ["let", "scheme", ["ext.url.parse.url_scheme", "parsed_view", "url_view"]],
        ["try", ["std.test.assert_bytes_eq", "scheme", ["bytes.lit", "https"], ["std.test.code_assert_bytes_eq"]]],
        ["let", "host", ["ext.url.parse.url_host", "parsed_view", "url_view"]],
        ["try", ["std.test.assert_bytes_eq", "host", ["bytes.lit", "example.com"], ["std.test.code_assert_bytes_eq"]]],
        ["let", "port", ["ext.url.parse.url_port", "parsed_view", "url_view"]],
        ["try", ["std.test.assert_bytes_eq", "port", ["bytes.lit", "8080"], ["std.test.code_assert_bytes_eq"]]],
        ["let", "path", ["ext.url.parse.url_path", "parsed_view", "url_view"]],
        ["try", ["std.test.assert_bytes_eq", "path", ["bytes.lit", "/path"], ["std.test.code_assert_bytes_eq"]]],
        ["std.test.pass"]
      ]
    },
    {
      "kind": "defn",
      "name": "ext.url.tests.test_percent_encode_roundtrip",
      "params": [],
      "result": "result_i32",
      "body": ["begin",
        ["let", "v", ["vec_u8.with_capacity", 11]],
        ["set", "v", ["vec_u8.extend_bytes", "v", ["bytes.lit", "hello"]]],
        ["set", "v", ["vec_u8.push", "v", 32]],
        ["set", "v", ["vec_u8.extend_bytes", "v", ["bytes.lit", "world"]]],
        ["let", "input_bytes", ["vec_u8.into_bytes", "v"]],
        ["let", "encoded", ["ext.url.encode.percent_encode", ["bytes.view", "input_bytes"]]],
        ["let", "decoded", ["ext.url.encode.percent_decode", ["bytes.view", "encoded"]]],
        ["let", "expected", ["bytes.lit", "hello%20world"]],
        ["try", ["std.test.assert_bytes_eq", "encoded", "expected", ["std.test.code_assert_bytes_eq"]]],
        ["try", ["std.test.assert_bytes_eq", "decoded", "input_bytes", ["std.test.code_assert_bytes_eq"]]],
        ["std.test.pass"]
      ]
    }
  ]
}
