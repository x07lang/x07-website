{"decls":[{"kind":"export","names":["app.util.bounded_queue_get","app.util.bounded_queue_len","app.util.bounded_queue_new","app.util.bounded_queue_push"]},{"body":["begin",["let","elem_size",["std.u32.read_le_at","queue",8]],["let","off",["+",12,["*","idx","elem_size"]]],["ty.read_le_at",["t","T"],"queue","off"]],"kind":"defn","name":"app.util.bounded_queue_get","params":[{"name":"queue","ty":"bytes_view"},{"name":"idx","ty":"i32"}],"result":["t","T"],"type_params":[{"bound":"num_like","name":"T"}]},{"body":["std.u32.read_le_at","queue",4],"kind":"defn","name":"app.util.bounded_queue_len","params":[{"name":"queue","ty":"bytes_view"}],"result":"i32","type_params":[{"bound":"num_like","name":"T"}]},{"body":["begin",["let","cap",["if",["<","capacity",1],1,"capacity"]],["let","elem_size",["ty.size",["t","T"]]],["let","header_size",12],["let","total",["+","header_size",["*","cap","elem_size"]]],["let","buf",["std.bytes.alloc","total"]],["set","buf",["std.u32.write_le_at","buf",0,"cap"]],["set","buf",["std.u32.write_le_at","buf",4,0]],["set","buf",["std.u32.write_le_at","buf",8,"elem_size"]],"buf"],"kind":"defn","name":"app.util.bounded_queue_new","params":[{"name":"capacity","ty":"i32"}],"result":"bytes","type_params":[{"bound":"num_like","name":"T"}]},{"body":["begin",["let","cap",["std.u32.read_le_at",["bytes.view","queue"],0]],["let","len",["std.u32.read_le_at",["bytes.view","queue"],4]],["let","elem_size",["std.u32.read_le_at",["bytes.view","queue"],8]],["if",[">=u","len","cap"],["return","queue"],0],["let","off",["+",12,["*","len","elem_size"]]],["set","queue",["ty.write_le_at",["t","T"],"queue","off","val"]],["set","queue",["std.u32.write_le_at","queue",4,["+","len",1]]],"queue"],"kind":"defn","name":"app.util.bounded_queue_push","params":[{"name":"queue","ty":"bytes"},{"name":"val","ty":["t","T"]}],"result":"bytes","type_params":[{"bound":"num_like","name":"T"}]}],"imports":["std.bytes","std.hash","std.u32","std.vec"],"kind":"module","module_id":"app.util","schema_version":"x07.x07ast@0.5.0"}
