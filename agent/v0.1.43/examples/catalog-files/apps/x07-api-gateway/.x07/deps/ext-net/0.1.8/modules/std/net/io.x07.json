{"decls":[{"kind":"export","names":["std.net.io.write_all_task_v1","std.net.io.write_all_v1"]},{"body":["begin",["let","out",["vec_u8.with_capacity",8]],["set","out",["vec_u8.push","out",1]],["set","out",["vec_u8.push","out",1]],["set","out",["vec_u8.push","out",0]],["set","out",["vec_u8.push","out",0]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","total"]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"std.net.io._ok_u32_doc_v1","params":[{"name":"total","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","data"]],["if",["<=","n",0],["return",["std.net.io._ok_u32_doc_v1",0]],0],["let","pos",0],["let","total",0],["for","_",0,2147483647,["begin",["if",[">=u","pos","n"],["return",["std.net.io._ok_u32_doc_v1","total"]],0],["let","chunk",["view.slice","data","pos",["-","n","pos"]]],["let","doc",["std.net.tcp.stream_write_v1","stream_handle","chunk","caps"]],["let","is_err",["begin",["let","dv",["bytes.view","doc"]],["std.net.err.is_err_doc_v1","dv"]]],["if","is_err",["return","doc"],0],["let","wrote",["begin",["let","dv",["bytes.view","doc"]],["std.net.tcp.stream_write_bytes_written_v1","dv"]]],["if",["<=","wrote",0],["return",["std.net.err.make_doc_v1",["std.net.err.code_connect_v1"]]],0],["set","pos",["+","pos","wrote"]],["set","total",["+","total","wrote"]],0]],["std.net.err.make_doc_v1",["std.net.err.code_internal_v1"]]],"kind":"defn","name":"std.net.io.write_all_v1","params":[{"name":"stream_handle","ty":"i32"},{"name":"data","ty":"bytes_view"},{"name":"caps","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","data"]],["if",["<=","n",0],["return",["std.net.io._ok_u32_doc_v1",0]],0],["let","pos",0],["let","total",0],["for","_",0,2147483647,["begin",["if",[">=u","pos","n"],["return",["std.net.io._ok_u32_doc_v1","total"]],0],["let","chunk",["view.slice","data","pos",["-","n","pos"]]],["let","h",["std.net.tcp.stream_write_task_v1","stream_handle","chunk","caps","max_iters"]],["task.spawn","h"],["let","doc",["await","h"]],["let","is_err",["std.net.err.is_err_doc_v1","doc"]],["if","is_err",["begin",["let","code",["std.net.err.err_code_v1","doc"]],["return",["std.net.err.make_doc_v1","code"]],0],0],["let","wrote",["std.net.tcp.stream_write_bytes_written_v1","doc"]],["if",["<=","wrote",0],["return",["std.net.err.make_doc_v1",["std.net.err.code_connect_v1"]]],0],["set","pos",["+","pos","wrote"]],["set","total",["+","total","wrote"]],0]],["std.net.err.make_doc_v1",["std.net.err.code_internal_v1"]]],"kind":"defasync","name":"std.net.io.write_all_task_v1","params":[{"name":"stream_handle","ty":"i32"},{"name":"data","ty":"bytes_view"},{"name":"caps","ty":"bytes_view"},{"name":"max_iters","ty":"i32"}],"result":"bytes"}],"imports":["std.net.err","std.net.tcp"],"kind":"module","module_id":"std.net.io","schema_version":"x07.x07ast@0.3.0"}
