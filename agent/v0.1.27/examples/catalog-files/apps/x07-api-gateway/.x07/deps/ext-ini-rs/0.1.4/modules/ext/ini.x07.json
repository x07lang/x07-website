{"decls":[{"kind":"export","names":["ext.ini.ini_get_string","ext.ini.ini_is_err","ext.ini.ini_parse"]},{"body":["begin",["if",["=",["<u","start","end"],0],["return",["vec_u8.into_bytes",["vec_u8.push",["vec_u8.with_capacity",1],0]]],0],["if",["=",["=",["view.get_u8","b","start"],34],0],["return",["vec_u8.into_bytes",["vec_u8.push",["vec_u8.with_capacity",1],0]]],0],["if",["=",["<u",["+","start",1],"end"],0],["return",["vec_u8.into_bytes",["vec_u8.push",["vec_u8.with_capacity",1],0]]],0],["if",["=",["=",["view.get_u8","b",["-","end",1]],34],0],["return",["vec_u8.into_bytes",["vec_u8.push",["vec_u8.with_capacity",1],0]]],0],["let","out",["vec_u8.with_capacity",["+",1,["-","end","start"]]]],["set","out",["vec_u8.push","out",1]],["let","i",["+","start",1]],["let","done",0],["let","ok",1],["for","_",["+","start",1],"end",["if",["=","done",0],["if",["=","ok",0],["set","done",1],["if",[">=u","i",["-","end",1]],["set","done",1],["begin",["let","c",["view.get_u8","b","i"]],["if",["=","c",92],["if",[">=u",["+","i",1],["-","end",1]],["set","ok",0],["begin",["let","next",["view.get_u8","b",["+","i",1]]],["if",["=","next",110],["set","out",["vec_u8.push","out",10]],["if",["=","next",116],["set","out",["vec_u8.push","out",9]],["if",["=","next",114],["set","out",["vec_u8.push","out",13]],["if",["=","next",92],["set","out",["vec_u8.push","out",92]],["if",["=","next",34],["set","out",["vec_u8.push","out",34]],["set","out",["vec_u8.push","out","next"]]]]]]],["set","i",["+","i",2]]]],["begin",["set","out",["vec_u8.push","out","c"]],["set","i",["+","i",1]]]]]]],0]],["if","ok",["vec_u8.into_bytes","out"],["vec_u8.into_bytes",["vec_u8.push",["vec_u8.with_capacity",1],0]]]],"kind":"defn","name":"ext.ini._decode_quoted_status","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"}],"result":"bytes"},{"body":["vec_u8.into_bytes",["vec_u8.with_capacity",0]],"kind":"defn","name":"ext.ini._empty_bytes","params":[],"result":"bytes"},{"body":["begin",["let","n",["view.len","b"]],["let","i","start"],["let","found",["-",0,1]],["for","_","start","n",["if",["<u","i","n"],["if",["<","found",0],["begin",["if",["=",["view.get_u8","b","i"],10],["set","found","i"],0],["set","i",["+","i",1]]],0],0]],["if",["<","found",0],"n","found"]],"kind":"defn","name":"ext.ini._find_newline","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"i32"},{"body":["begin",["let","key_len",["view.len","key"]],["let","off",0],["for","_",0,"entry_count",["begin",["let","k_len",["ext.ini._read_u32_le","entries","off"]],["let","k_start",["+","off",4]],["let","next",["+","k_start","k_len"]],["if",["=","k_len","key_len"],["begin",["let","match_flag",1],["for","j",0,"k_len",["if","match_flag",["if",["=",["=",["view.get_u8","entries",["+","k_start","j"]],["view.get_u8","key","j"]],0],["set","match_flag",0],0],0]],["if","match_flag",["return",1],0]],0],["let","v_len",["ext.ini._read_u32_le","entries","next"]],["set","next",["+",["+","next",4],"v_len"]],["set","off","next"]]],0],"kind":"defn","name":"ext.ini._has_key","params":[{"name":"entries","ty":"bytes_view"},{"name":"key","ty":"bytes_view"},{"name":"entry_count","ty":"i32"}],"result":"i32"},{"body":["if",["if",["=","c",32],1,["=","c",9]],1,["=","c",13]],"kind":"defn","name":"ext.ini._is_ws","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["let","out",["vec_u8.with_capacity",9]],["set","out",["vec_u8.push","out",0]],["set","out",["ext.ini._push_u32_le","out","code"]],["set","out",["ext.ini._push_u32_le","out",0]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.ini._make_error_code","params":[{"name":"code","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","o","out"],["set","o",["vec_u8.push","o",["&","val",255]]],["set","o",["vec_u8.push","o",["&",[">>u","val",8],255]]],["set","o",["vec_u8.push","o",["&",[">>u","val",16],255]]],["set","o",["vec_u8.push","o",["&",[">>u","val",24],255]]],"o"],"kind":"defn","name":"ext.ini._push_u32_le","params":[{"name":"out","ty":"vec_u8"},{"name":"val","ty":"i32"}],"result":"vec_u8"},{"body":["begin",["let","b0",["view.get_u8","b","offset"]],["let","b1",["view.get_u8","b",["+","offset",1]]],["let","b2",["view.get_u8","b",["+","offset",2]]],["let","b3",["view.get_u8","b",["+","offset",3]]],["+",["+",["+","b0",["<<u","b1",8]],["<<u","b2",16]],["<<u","b3",24]]],"kind":"defn","name":"ext.ini._read_u32_le","params":[{"name":"b","ty":"bytes_view"},{"name":"offset","ty":"i32"}],"result":"i32"},{"body":["begin",["let","i","start"],["for","_","start","end",["if",["<u","i","end"],["if",["ext.ini._is_ws",["view.get_u8","b","i"]],["set","i",["+","i",1]],0],0]],"i"],"kind":"defn","name":"ext.ini._skip_ws","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"}],"result":"i32"},{"body":["begin",["if",["=",["<u","start","end"],0],["return","end"],0],["let","r","end"],["let","i",["-","end",1]],["let","done",0],["for","_","start","end",["if",["=","done",0],["if",["<","i","start"],["set","done",1],["begin",["let","c",["view.get_u8","b","i"]],["if",["ext.ini._is_ws","c"],["begin",["set","r","i"],["set","i",["-","i",1]]],["set","done",1]]]],0]],"r"],"kind":"defn","name":"ext.ini._trim_end_ws","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","doc"]],["if",["<","n",5],["return",["ext.ini._empty_bytes"]],0],["if",["=",["=",["view.get_u8","doc",0],1],0],["return",["ext.ini._empty_bytes"]],0],["let","entry_count",["ext.ini._read_u32_le","doc",1]],["let","key_len",["view.len","key"]],["let","pos",5],["for","_",0,"entry_count",["begin",["if",["=",["<u",["+","pos",4],["+","n",1]],0],["return",["ext.ini._empty_bytes"]],0],["let","ek_len",["ext.ini._read_u32_le","doc","pos"]],["set","pos",["+","pos",4]],["if",["=",["<u",["+","pos","ek_len"],["+","n",1]],0],["return",["ext.ini._empty_bytes"]],0],["let","match_flag",1],["if",["=",["=","ek_len","key_len"],0],["set","match_flag",0],0],["if","match_flag",["for","j",0,"ek_len",["if","match_flag",["if",["=",["=",["view.get_u8","doc",["+","pos","j"]],["view.get_u8","key","j"]],0],["set","match_flag",0],0],0]],0],["set","pos",["+","pos","ek_len"]],["if",["=",["<u",["+","pos",4],["+","n",1]],0],["return",["ext.ini._empty_bytes"]],0],["let","v_len",["ext.ini._read_u32_le","doc","pos"]],["set","pos",["+","pos",4]],["if",["=",["<u",["+","pos","v_len"],["+","n",1]],0],["return",["ext.ini._empty_bytes"]],0],["if","match_flag",["return",["view.to_bytes",["view.slice","doc","pos","v_len"]]],0],["set","pos",["+","pos","v_len"]]]],["ext.ini._empty_bytes"]],"kind":"defn","name":"ext.ini.ini_get_string","params":[{"name":"doc","ty":"bytes_view"},{"name":"key","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["<",["view.len","doc"],1],["return",1],0],["if",["=",["view.get_u8","doc",0],0],1,0]],"kind":"defn","name":"ext.ini.ini_is_err","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","n",["view.len","src"]],["let","entries",["vec_u8.with_capacity",256]],["let","count",0],["let","section",["vec_u8.with_capacity",0]],["let","pos",0],["let","done",0],["for","_",0,["+","n",1],["if",["=","done",0],["if",[">=u","pos","n"],["set","done",1],["begin",["let","line_start","pos"],["let","line_end",["ext.ini._find_newline","src","pos"]],["set","pos",["if",["<u","line_end","n"],["+","line_end",1],"line_end"]],["let","trimmed_end",["ext.ini._trim_end_ws","src","line_start","line_end"]],["let","start",["ext.ini._skip_ws","src","line_start","trimmed_end"]],["if",["=",["<u","start","trimmed_end"],0],0,["begin",["let","c0",["view.get_u8","src","start"]],["if",["if",["=","c0",59],1,["=","c0",35]],0,["if",["=","c0",91],["begin",["let","i",["+","start",1]],["let","close",["-",0,1]],["for","_",["+","start",1],"trimmed_end",["if",["<u","i","trimmed_end"],["if",["<","close",0],["begin",["if",["=",["view.get_u8","src","i"],93],["set","close","i"],0],["set","i",["+","i",1]]],0],0]],["if",["<","close",0],["return",["ext.ini._make_error_code",1]],0],["let","sec_start0",["+","start",1]],["let","sec_end0","close"],["let","sec_start",["ext.ini._skip_ws","src","sec_start0","sec_end0"]],["let","sec_end",["ext.ini._trim_end_ws","src","sec_start","sec_end0"]],["if",["=",["<u","sec_start","sec_end"],0],["return",["ext.ini._make_error_code",1]],0],["let","sec_len",["-","sec_end","sec_start"]],["let","sec",["vec_u8.with_capacity",["+","sec_len",1]]],["for","j","sec_start","sec_end",["set","sec",["vec_u8.push","sec",["view.get_u8","src","j"]]]],["set","sec",["vec_u8.push","sec",46]],["set","section","sec"],0],["begin",["let","i","start"],["let","delim",["-",0,1]],["for","_","start","trimmed_end",["if",["<u","i","trimmed_end"],["if",["<","delim",0],["begin",["let","c",["view.get_u8","src","i"]],["if",["if",["=","c",61],1,["=","c",58]],["set","delim","i"],0],["set","i",["+","i",1]]],0],0]],["if",["<","delim",0],["return",["ext.ini._make_error_code",2]],0],["let","key_start0","start"],["let","key_end0","delim"],["let","key_start",["ext.ini._skip_ws","src","key_start0","key_end0"]],["let","key_end",["ext.ini._trim_end_ws","src","key_start","key_end0"]],["if",["=",["<u","key_start","key_end"],0],["return",["ext.ini._make_error_code",2]],0],["let","sec_view",["vec_u8.as_view","section"]],["let","sec_len",["view.len","sec_view"]],["let","key_len",["-","key_end","key_start"]],["let","full_key_len",["+","sec_len","key_len"]],["let","key_buf",["vec_u8.with_capacity","full_key_len"]],["for","j",0,"sec_len",["set","key_buf",["vec_u8.push","key_buf",["view.get_u8","sec_view","j"]]]],["for","j","key_start","key_end",["set","key_buf",["vec_u8.push","key_buf",["view.get_u8","src","j"]]]],["let","key_view",["vec_u8.as_view","key_buf"]],["if",["ext.ini._has_key",["vec_u8.as_view","entries"],"key_view","count"],["return",["ext.ini._make_error_code",4]],0],["let","val_start0",["+","delim",1]],["set","val_start0",["ext.ini._skip_ws","src","val_start0","trimmed_end"]],["let","val_end0","trimmed_end"],["set","val_end0",["ext.ini._trim_end_ws","src","val_start0","val_end0"]],["let","val_bytes",["ext.ini._empty_bytes"]],["let","val_off",0],["let","val_len2",0],["if",["=",["<u","val_start0","val_end0"],0],["begin",["set","val_bytes",["ext.ini._empty_bytes"]],["set","val_off",0],["set","val_len2",0]],["if",["=",["view.get_u8","src","val_start0"],34],["begin",["let","dec",["ext.ini._decode_quoted_status","src","val_start0","val_end0"]],["if",["<",["bytes.len","dec"],1],["return",["ext.ini._make_error_code",3]],0],["if",["=",["bytes.get_u8","dec",0],0],["return",["ext.ini._make_error_code",3]],0],["set","val_bytes","dec"],["set","val_off",1],["set","val_len2",["-",["bytes.len","val_bytes"],1]]],["begin",["let","out",["vec_u8.with_capacity",["-","val_end0","val_start0"]]],["for","j","val_start0","val_end0",["set","out",["vec_u8.push","out",["view.get_u8","src","j"]]]],["set","val_bytes",["vec_u8.into_bytes","out"]],["set","val_off",0],["set","val_len2",["bytes.len","val_bytes"]]]]],["set","entries",["ext.ini._push_u32_le","entries","full_key_len"]],["set","entries",["vec_u8.extend_bytes_range","entries","key_view",0,"full_key_len"]],["set","entries",["ext.ini._push_u32_le","entries","val_len2"]],["let","vv",["bytes.view","val_bytes"]],["set","entries",["vec_u8.extend_bytes_range","entries","vv","val_off","val_len2"]],["set","count",["+","count",1]],0]]]]]]],0]],["let","entries_b",["vec_u8.into_bytes","entries"]],["let","entries_v",["bytes.view","entries_b"]],["let","entries_len",["view.len","entries_v"]],["let","out",["vec_u8.with_capacity",["+",5,"entries_len"]]],["set","out",["vec_u8.push","out",1]],["set","out",["ext.ini._push_u32_le","out","count"]],["set","out",["vec_u8.extend_bytes_range","out","entries_v",0,"entries_len"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.ini.ini_parse","params":[{"name":"src","ty":"bytes_view"}],"result":"bytes"}],"imports":[],"kind":"module","meta":{"generated_by":"x07import","source_path":"tests/x07import/fixtures/import_sources/rust/ext_ini@0.1.0/ini.rs","source_sha256":"c291529e224692ca0f9c3d0d93263496affdf4fe84e905ae590699321b783152"},"module_id":"ext.ini","schema_version":"x07.x07ast@0.3.0"}
