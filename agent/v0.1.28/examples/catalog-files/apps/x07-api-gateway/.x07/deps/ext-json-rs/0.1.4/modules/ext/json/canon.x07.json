{"decls":[{"kind":"export","names":["ext.json.canon.canonicalize"]},{"body":["begin",["let","a_off",["codec.read_u32_le","offsets",["*","a",4]]],["let","b_off",["codec.read_u32_le","offsets",["*","b",4]]],["let","a_len",["codec.read_u32_le","members","a_off"]],["let","b_len",["codec.read_u32_le","members","b_off"]],["let","a_start",["+","a_off",4]],["let","b_start",["+","b_off",4]],["let","min_len",["if",["<u","a_len","b_len"],"a_len","b_len"]],["for","i",0,"min_len",["begin",["let","ac",["view.get_u8","members",["+","a_start","i"]]],["let","bc",["view.get_u8","members",["+","b_start","i"]]],["if",["<","ac","bc"],["return",["-",0,1]],0],["if",[">","ac","bc"],["return",1],0]]],["if",["<","a_len","b_len"],["-",0,1],["if",[">","a_len","b_len"],1,0]]],"kind":"defn","name":"ext.json.canon._cmp_member_key","params":[{"name":"members","ty":"bytes_view"},{"name":"offsets","ty":"bytes_view"},{"name":"a","ty":"i32"},{"name":"b","ty":"i32"}],"result":"i32"},{"body":["begin",["let","off",["codec.read_u32_le","offsets",["*","idx",4]]],["let","key_len",["codec.read_u32_le","members","off"]],["let","key_start",["+","off",4]],["let","val_len_off",["+","key_start","key_len"]],["let","val_len",["codec.read_u32_le","members","val_len_off"]],["let","val_start",["+","val_len_off",4]],["let","o","out"],["set","o",["vec_u8.push","o",34]],["set","o",["vec_u8.extend_bytes_range","o","members","key_start","key_len"]],["set","o",["vec_u8.push","o",34]],["set","o",["vec_u8.push","o",58]],["set","o",["vec_u8.extend_bytes_range","o","members","val_start","val_len"]],"o"],"kind":"defn","name":"ext.json.canon._emit_member_kv","params":[{"name":"members","ty":"bytes_view"},{"name":"offsets","ty":"bytes_view"},{"name":"idx","ty":"i32"},{"name":"out","ty":"vec_u8"}],"result":"vec_u8"},{"body":["begin",["let","o","out"],["set","o",["vec_u8.push","o",123]],["let","used",["bytes.alloc","count"]],["let","first",1],["for","_",0,"count",["begin",["let","best",["-",0,1]],["for","j",0,"count",["if",["=",["bytes.get_u8","used","j"],1],0,["if",["<","best",0],["set","best","j"],["if",["<",["ext.json.canon._cmp_member_key","members","offsets","j","best"],0],["set","best","j"],0]]]],["set","used",["bytes.set_u8","used","best",1]],["if",["=","first",0],["set","o",["vec_u8.push","o",44]],["set","first",0]],["set","o",["ext.json.canon._emit_member_kv","members","offsets","best","o"]]]],["set","o",["vec_u8.push","o",125]],"o"],"kind":"defn","name":"ext.json.canon._emit_object_sorted","params":[{"name":"members","ty":"bytes_view"},{"name":"offsets","ty":"bytes_view"},{"name":"count","ty":"i32"},{"name":"out","ty":"vec_u8"}],"result":"vec_u8"},{"body":["begin",["if",[">=u","c",48],["if",["<u","c",58],["return",1],0],0],0],"kind":"defn","name":"ext.json.canon._is_digit","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["if",[">=u","c",48],["if",["<u","c",58],["return",1],0],0],["if",[">=u","c",65],["if",["<u","c",71],["return",1],0],0],["if",[">=u","c",97],["if",["<u","c",103],["return",1],0],0],0],"kind":"defn","name":"ext.json.canon._is_hex_digit","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["if",["if",["if",["=","c",32],1,["=","c",9]],1,["=","c",10]],1,["=","c",13]],"kind":"defn","name":"ext.json.canon._is_ws","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["let","out",["vec_u8.with_capacity","n"]],["set","out",["vec_u8.push","out",91]],["let","i",["ext.json.canon._skip_ws","b",["+","off",1]]],["if",[">=u","i","n"],["return",["bytes.alloc",0]],0],["if",["=",["view.get_u8","b","i"],93],["begin",["set","out",["vec_u8.push","out",93]],["return",["vec_u8.into_bytes","out"]]],0],["let","first",1],["for","_",0,["+","n",1],["begin",["if",["=","first",0],["set","out",["vec_u8.push","out",44]],["set","first",0]],["let","value",["ext.json.canon._parse_value","b","i"]],["if",["=",["bytes.len","value"],0],["return",["bytes.alloc",0]],0],["set","out",["vec_u8.extend_bytes","out","value"]],["let","end",["ext.json.canon._skip_value","b","i"]],["if",["<","end",0],["return",["bytes.alloc",0]],0],["set","i",["ext.json.canon._skip_ws","b","end"]],["if",[">=u","i","n"],["return",["bytes.alloc",0]],0],["let","c",["view.get_u8","b","i"]],["if",["=","c",44],["set","i",["ext.json.canon._skip_ws","b",["+","i",1]]],["if",["=","c",93],["begin",["set","out",["vec_u8.push","out",93]],["return",["vec_u8.into_bytes","out"]]],["return",["bytes.alloc",0]]]]]],["bytes.alloc",0]],"kind":"defn","name":"ext.json.canon._parse_array","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","end",["ext.json.canon._skip_lit","b","off","c0","c1","c2","c3","c4"]],["if",["<","end",0],["return",["bytes.alloc",0]],0],["view.to_bytes",["view.slice","b","off",["-","end","off"]]]],"kind":"defn","name":"ext.json.canon._parse_lit","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"},{"name":"c0","ty":"i32"},{"name":"c1","ty":"i32"},{"name":"c2","ty":"i32"},{"name":"c3","ty":"i32"},{"name":"c4","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","end",["ext.json.canon._skip_number","b","off"]],["if",["<","end",0],["return",["bytes.alloc",0]],0],["view.to_bytes",["view.slice","b","off",["-","end","off"]]]],"kind":"defn","name":"ext.json.canon._parse_number","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","b"]],["let","i",["ext.json.canon._skip_ws","b",["+","off",1]]],["if",[">=u","i","n"],["return",["bytes.alloc",0]],0],["if",["=",["view.get_u8","b","i"],125],["begin",["let","out",["vec_u8.with_capacity",2]],["set","out",["vec_u8.push","out",123]],["set","out",["vec_u8.push","out",125]],["return",["vec_u8.into_bytes","out"]]],0],["let","members",["vec_u8.with_capacity",0]],["let","offsets",["vec_u8.with_capacity",0]],["let","count",0],["for","_",0,["+","n",1],["begin",["if",[">=u","i","n"],["return",["bytes.alloc",0]],0],["if",["=",["=",["view.get_u8","b","i"],34],0],["return",["bytes.alloc",0]],0],["let","key_start",["+","i",1]],["let","key_end",["ext.json.canon._string_end_or_err","b","key_start"]],["if",["<","key_end",0],["return",["bytes.alloc",0]],0],["let","key_len",["-","key_end","key_start"]],["set","i",["+","key_end",1]],["set","i",["ext.json.canon._skip_ws","b","i"]],["if",[">=u","i","n"],["return",["bytes.alloc",0]],0],["if",["=",["=",["view.get_u8","b","i"],58],0],["return",["bytes.alloc",0]],0],["set","i",["+","i",1]],["let","value",["ext.json.canon._parse_value","b","i"]],["let","val_len",["bytes.len","value"]],["if",["=","val_len",0],["return",["bytes.alloc",0]],0],["let","val_end",["ext.json.canon._skip_value","b","i"]],["if",["<","val_end",0],["return",["bytes.alloc",0]],0],["set","i",["ext.json.canon._skip_ws","b","val_end"]],["let","m_off",["vec_u8.len","members"]],["set","offsets",["vec_u8.extend_bytes","offsets",["codec.write_u32_le","m_off"]]],["set","members",["vec_u8.extend_bytes","members",["codec.write_u32_le","key_len"]]],["set","members",["vec_u8.extend_bytes_range","members","b","key_start","key_len"]],["set","members",["vec_u8.extend_bytes","members",["codec.write_u32_le","val_len"]]],["set","members",["vec_u8.extend_bytes","members","value"]],["set","count",["+","count",1]],["if",[">=u","i","n"],["return",["bytes.alloc",0]],0],["let","c",["view.get_u8","b","i"]],["if",["=","c",44],["set","i",["ext.json.canon._skip_ws","b",["+","i",1]]],["if",["=","c",125],["begin",["let","members_b",["vec_u8.into_bytes","members"]],["let","offsets_b",["vec_u8.into_bytes","offsets"]],["let","out",["vec_u8.with_capacity",["view.len","b"]]],["set","out",["ext.json.canon._emit_object_sorted",["bytes.view","members_b"],["bytes.view","offsets_b"],"count","out"]],["return",["vec_u8.into_bytes","out"]]],["return",["bytes.alloc",0]]]]]],["bytes.alloc",0]],"kind":"defn","name":"ext.json.canon._parse_object","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","end_quote",["ext.json.canon._string_end_or_err","b",["+","off",1]]],["if",["<","end_quote",0],["return",["bytes.alloc",0]],0],["view.to_bytes",["view.slice","b","off",["+",["-","end_quote","off"],1]]]],"kind":"defn","name":"ext.json.canon._parse_string","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","b"]],["let","i",["ext.json.canon._skip_ws","b","off"]],["if",[">=u","i","n"],["return",["bytes.alloc",0]],0],["let","c",["view.get_u8","b","i"]],["if",["=","c",123],["return",["ext.json.canon._parse_object","b","i"]],0],["if",["=","c",91],["return",["ext.json.canon._parse_array","b","i"]],0],["if",["=","c",34],["return",["ext.json.canon._parse_string","b","i"]],0],["if",["=","c",116],["return",["ext.json.canon._parse_lit","b","i",116,114,117,101,["-",0,1]]],0],["if",["=","c",102],["return",["ext.json.canon._parse_lit","b","i",102,97,108,115,101]],0],["if",["=","c",110],["return",["ext.json.canon._parse_lit","b","i",110,117,108,108,["-",0,1]]],0],["if",["if",["=","c",45],1,["ext.json.canon._is_digit","c"]],["return",["ext.json.canon._parse_number","b","i"]],0],["bytes.alloc",0]],"kind":"defn","name":"ext.json.canon._parse_value","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","b"]],["let","i",["ext.json.canon._skip_ws","b",["+","off",1]]],["if",[">=u","i","n"],["return",["-",0,1]],0],["if",["=",["view.get_u8","b","i"],93],["return",["+","i",1]],0],["for","_",0,["+","n",1],["begin",["let","end",["ext.json.canon._skip_value","b","i"]],["if",["<","end",0],["return",["-",0,1]],0],["set","i",["ext.json.canon._skip_ws","b","end"]],["if",[">=u","i","n"],["return",["-",0,1]],0],["let","c",["view.get_u8","b","i"]],["if",["=","c",44],["set","i",["ext.json.canon._skip_ws","b",["+","i",1]]],["if",["=","c",93],["return",["+","i",1]],["return",["-",0,1]]]]]],["-",0,1]],"kind":"defn","name":"ext.json.canon._skip_array","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["if",["<","c4",0],["begin",["if",["=",["<u",["+","off",3],"n"],0],["return",["-",0,1]],0],["if",["=",["=",["view.get_u8","b","off"],"c0"],0],["return",["-",0,1]],0],["if",["=",["=",["view.get_u8","b",["+","off",1]],"c1"],0],["return",["-",0,1]],0],["if",["=",["=",["view.get_u8","b",["+","off",2]],"c2"],0],["return",["-",0,1]],0],["if",["=",["=",["view.get_u8","b",["+","off",3]],"c3"],0],["return",["-",0,1]],0],["return",["+","off",4]]],0],["if",["=",["<u",["+","off",4],"n"],0],["return",["-",0,1]],0],["if",["=",["=",["view.get_u8","b","off"],"c0"],0],["return",["-",0,1]],0],["if",["=",["=",["view.get_u8","b",["+","off",1]],"c1"],0],["return",["-",0,1]],0],["if",["=",["=",["view.get_u8","b",["+","off",2]],"c2"],0],["return",["-",0,1]],0],["if",["=",["=",["view.get_u8","b",["+","off",3]],"c3"],0],["return",["-",0,1]],0],["if",["=",["=",["view.get_u8","b",["+","off",4]],"c4"],0],["return",["-",0,1]],0],["+","off",5]],"kind":"defn","name":"ext.json.canon._skip_lit","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"},{"name":"c0","ty":"i32"},{"name":"c1","ty":"i32"},{"name":"c2","ty":"i32"},{"name":"c3","ty":"i32"},{"name":"c4","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["let","i","off"],["if",[">=u","i","n"],["return",["-",0,1]],0],["if",["=",["view.get_u8","b","i"],45],["begin",["set","i",["+","i",1]],["if",[">=u","i","n"],["return",["-",0,1]],0]],0],["if",[">=u","i","n"],["return",["-",0,1]],0],["let","d0",["view.get_u8","b","i"]],["if",["=",["ext.json.canon._is_digit","d0"],0],["return",["-",0,1]],0],["if",["=","d0",48],["begin",["set","i",["+","i",1]],["if",["if",["<u","i","n"],["ext.json.canon._is_digit",["view.get_u8","b","i"]],0],["return",["-",0,1]],0]],["begin",["set","i",["+","i",1]],["let","done",0],["for","_",0,"n",["if",["=","done",0],["if",[">=u","i","n"],["set","done",1],["if",["ext.json.canon._is_digit",["view.get_u8","b","i"]],["set","i",["+","i",1]],["set","done",1]]],0]]]],["if",["if",["<u","i","n"],["=",["view.get_u8","b","i"],46],0],["begin",["set","i",["+","i",1]],["if",[">=u","i","n"],["return",["-",0,1]],0],["if",["=",["ext.json.canon._is_digit",["view.get_u8","b","i"]],0],["return",["-",0,1]],0],["set","i",["+","i",1]],["let","done",0],["for","_",0,"n",["if",["=","done",0],["if",[">=u","i","n"],["set","done",1],["if",["ext.json.canon._is_digit",["view.get_u8","b","i"]],["set","i",["+","i",1]],["set","done",1]]],0]]],0],["if",["<u","i","n"],["begin",["let","e",["view.get_u8","b","i"]],["if",["if",["=","e",101],1,["=","e",69]],["begin",["set","i",["+","i",1]],["if",[">=u","i","n"],["return",["-",0,1]],0],["let","sign",["view.get_u8","b","i"]],["if",["if",["=","sign",43],1,["=","sign",45]],["begin",["set","i",["+","i",1]],["if",[">=u","i","n"],["return",["-",0,1]],0]],0],["if",["=",["ext.json.canon._is_digit",["view.get_u8","b","i"]],0],["return",["-",0,1]],0],["set","i",["+","i",1]],["let","done",0],["for","_",0,"n",["if",["=","done",0],["if",[">=u","i","n"],["set","done",1],["if",["ext.json.canon._is_digit",["view.get_u8","b","i"]],["set","i",["+","i",1]],["set","done",1]]],0]]],0]],0],"i"],"kind":"defn","name":"ext.json.canon._skip_number","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["let","i",["ext.json.canon._skip_ws","b",["+","off",1]]],["if",[">=u","i","n"],["return",["-",0,1]],0],["if",["=",["view.get_u8","b","i"],125],["return",["+","i",1]],0],["for","_",0,["+","n",1],["begin",["if",[">=u","i","n"],["return",["-",0,1]],0],["if",["=",["=",["view.get_u8","b","i"],34],0],["return",["-",0,1]],0],["let","key_end",["ext.json.canon._string_end_or_err","b",["+","i",1]]],["if",["<","key_end",0],["return",["-",0,1]],0],["set","i",["+","key_end",1]],["set","i",["ext.json.canon._skip_ws","b","i"]],["if",[">=u","i","n"],["return",["-",0,1]],0],["if",["=",["=",["view.get_u8","b","i"],58],0],["return",["-",0,1]],0],["set","i",["ext.json.canon._skip_ws","b",["+","i",1]]],["let","end",["ext.json.canon._skip_value","b","i"]],["if",["<","end",0],["return",["-",0,1]],0],["set","i",["ext.json.canon._skip_ws","b","end"]],["if",[">=u","i","n"],["return",["-",0,1]],0],["let","c",["view.get_u8","b","i"]],["if",["=","c",44],["set","i",["ext.json.canon._skip_ws","b",["+","i",1]]],["if",["=","c",125],["return",["+","i",1]],["return",["-",0,1]]]]]],["-",0,1]],"kind":"defn","name":"ext.json.canon._skip_object","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["if",[">=u","off","n"],["return",["-",0,1]],0],["if",["=",["=",["view.get_u8","b","off"],34],0],["return",["-",0,1]],0],["let","end_quote",["ext.json.canon._string_end_or_err","b",["+","off",1]]],["if",["<","end_quote",0],["-",0,1],["+","end_quote",1]]],"kind":"defn","name":"ext.json.canon._skip_string","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["let","i",["ext.json.canon._skip_ws","b","off"]],["if",[">=u","i","n"],["return",["-",0,1]],0],["let","c",["view.get_u8","b","i"]],["if",["=","c",123],["return",["ext.json.canon._skip_object","b","i"]],0],["if",["=","c",91],["return",["ext.json.canon._skip_array","b","i"]],0],["if",["=","c",34],["return",["ext.json.canon._skip_string","b","i"]],0],["if",["=","c",116],["return",["ext.json.canon._skip_lit","b","i",116,114,117,101,["-",0,1]]],0],["if",["=","c",102],["return",["ext.json.canon._skip_lit","b","i",102,97,108,115,101]],0],["if",["=","c",110],["return",["ext.json.canon._skip_lit","b","i",110,117,108,108,["-",0,1]]],0],["if",["if",["=","c",45],1,["ext.json.canon._is_digit","c"]],["return",["ext.json.canon._skip_number","b","i"]],0],["-",0,1]],"kind":"defn","name":"ext.json.canon._skip_value","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["let","i","start"],["for","_","start","n",["if",["<u","i","n"],["if",["ext.json.canon._is_ws",["view.get_u8","b","i"]],["set","i",["+","i",1]],0],0]],"i"],"kind":"defn","name":"ext.json.canon._skip_ws","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["let","i","start"],["for","_","start","n",["if",["<u","i","n"],["begin",["let","c",["view.get_u8","b","i"]],["if",["=","c",34],["return","i"],0],["if",["=","c",92],["begin",["if",["=",["<u",["+","i",1],"n"],0],["return",["-",0,1]],0],["let","esc",["view.get_u8","b",["+","i",1]]],["if",["if",["if",["if",["if",["if",["if",["if",["=","esc",34],1,["=","esc",92]],1,["=","esc",47]],1,["=","esc",98]],1,["=","esc",102]],1,["=","esc",110]],1,["=","esc",114]],1,["=","esc",116]],["set","i",["+","i",2]],["if",["=","esc",117],["begin",["if",["=",["<u",["+","i",5],"n"],0],["return",["-",0,1]],0],["if",["if",["if",["if",["=",["ext.json.canon._is_hex_digit",["view.get_u8","b",["+","i",2]]],0],1,["=",["ext.json.canon._is_hex_digit",["view.get_u8","b",["+","i",3]]],0]],1,["=",["ext.json.canon._is_hex_digit",["view.get_u8","b",["+","i",4]]],0]],1,["=",["ext.json.canon._is_hex_digit",["view.get_u8","b",["+","i",5]]],0]],["return",["-",0,1]],0],["set","i",["+","i",6]]],["return",["-",0,1]]]]],["if",["<u","c",32],["return",["-",0,1]],["set","i",["+","i",1]]]]],0]],["-",0,1]],"kind":"defn","name":"ext.json.canon._string_end_or_err","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"i32"},{"body":["begin",["let","end",["ext.json.canon._skip_value","b",0]],["if",["<","end",0],["return",["bytes.alloc",0]],0],["let","end2",["ext.json.canon._skip_ws","b","end"]],["if",["=",["=","end2",["view.len","b"]],0],["return",["bytes.alloc",0]],0],["ext.json.canon._parse_value","b",0]],"kind":"defn","name":"ext.json.canon.canonicalize","params":[{"name":"b","ty":"bytes_view"}],"result":"bytes"}],"imports":[],"kind":"module","meta":{"generated_by":"x07import","source_path":"tests/x07import/fixtures/import_sources/rust/ext_json@0.1.0/canon.rs","source_sha256":"6e3a09dc1094a38fa1cd56e508d42fd0b6822898a1c22e75b20200803d59e34e"},"module_id":"ext.json.canon","schema_version":"x07.x07ast@0.3.0"}
