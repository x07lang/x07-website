{"decls":[{"kind":"export","names":["test_pure.bounded_queue","test_pure.canonical_json","test_pure.extract_title","test_pure.normalize_basic","test_pure.normalize_trailing_slash","test_pure.plan_dedup","test_pure.plan_max_pages","test_pure.prop_normalize_idempotent","test_pure.robots_empty_allows"]},{"body":["begin",["let","q",["tapp","app.util.bounded_queue_new",["tys","u32"],4]],["set","q",["tapp","app.util.bounded_queue_push",["tys","u32"],"q",42]],["set","q",["tapp","app.util.bounded_queue_push",["tys","u32"],"q",99]],["let","len",["tapp","app.util.bounded_queue_len",["tys","u32"],["bytes.view","q"]]],["try",["std.test.assert_i32_eq","len",2,["std.test.code_assert_i32_eq"]]],["let","v0",["tapp","app.util.bounded_queue_get",["tys","u32"],["bytes.view","q"],0]],["try",["std.test.assert_i32_eq","v0",42,["std.test.code_assert_i32_eq"]]],["let","v1",["tapp","app.util.bounded_queue_get",["tys","u32"],["bytes.view","q"],1]],["try",["std.test.assert_i32_eq","v1",99,["std.test.code_assert_i32_eq"]]],["std.test.pass"]],"kind":"defn","name":"test_pure.bounded_queue","params":[],"result":"result_i32"},{"body":["begin",["let","json",["bytes.lit","{\"b\":2,\"a\":1}"]],["let","canon",["ext.json.canon.canonicalize",["bytes.view","json"]]],["let","expected",["bytes.lit","{\"a\":1,\"b\":2}"]],["let","canon_copy",["std.bytes.copy",["bytes.view","canon"]]],["try",["std.test.assert_bytes_eq","canon","expected",["std.test.code_assert_bytes_eq"]]],["let","canon2",["ext.json.canon.canonicalize",["bytes.view","canon_copy"]]],["let","canon_copy2",["std.bytes.copy",["bytes.view","canon_copy"]]],["try",["std.test.assert_bytes_eq","canon_copy2","canon2",["std.test.code_assert_bytes_eq"]]],["std.test.pass"]],"kind":"defn","name":"test_pure.canonical_json","params":[],"result":"result_i32"},{"body":["begin",["let","html",["bytes.lit","<html><head><title>Hello World</title></head><body></body></html>"]],["let","url",["bytes.lit","https://example.com/"]],["let","origin",["bytes.lit","https://example.com"]],["let","record",["app.extract.extract_records_v1",["bytes.view","html"],["bytes.view","url"],["bytes.view","origin"]]],["try",["std.test.assert_true",[">",["view.len",["bytes.view","record"]],10],["std.test.code_assert_true"]]],["std.test.pass"]],"kind":"defn","name":"test_pure.extract_title","params":[],"result":"result_i32"},{"body":["begin",["let","url",["bytes.lit","https://example.com/page"]],["let","norm",["app.crawl.plan.normalize_url_v1",["bytes.view","url"]]],["try",["std.test.assert_true",[">",["view.len",["bytes.view","norm"]],0],["std.test.code_assert_true"]]],["std.test.pass"]],"kind":"defn","name":"test_pure.normalize_basic","params":[],"result":"result_i32"},{"body":["begin",["let","url1",["bytes.lit","https://example.com"]],["let","url2",["bytes.lit","https://example.com/"]],["let","n1",["app.crawl.plan.normalize_url_v1",["bytes.view","url1"]]],["let","n2",["app.crawl.plan.normalize_url_v1",["bytes.view","url2"]]],["try",["std.test.assert_bytes_eq","n1","n2",["std.test.code_assert_bytes_eq"]]],["std.test.pass"]],"kind":"defn","name":"test_pure.normalize_trailing_slash","params":[],"result":"result_i32"},{"body":["begin",["let","seeds",["bytes.lit","https://example.com/\nhttps://example.com/\nhttps://example.com/page"]],["let","robots",["bytes.lit",""]],["let","ua",["bytes.lit","x07crawl"]],["let","plan",["app.crawl.plan.plan_crawl_v1",["bytes.view","seeds"],["bytes.view","robots"],["bytes.view","ua"],10]],["let","sl",["std.text.ascii.split_lines_view",["bytes.view","plan"]]],["let","slv",["bytes.view","sl"]],["let","count",["std.text.slices.count_v1","slv"]],["try",["std.test.assert_i32_eq","count",2,["std.test.code_assert_i32_eq"]]],["std.test.pass"]],"kind":"defn","name":"test_pure.plan_dedup","params":[],"result":"result_i32"},{"body":["begin",["let","seeds",["bytes.lit","https://a.com/\nhttps://b.com/\nhttps://c.com/\nhttps://d.com/"]],["let","robots",["bytes.lit",""]],["let","ua",["bytes.lit","bot"]],["let","plan",["app.crawl.plan.plan_crawl_v1",["bytes.view","seeds"],["bytes.view","robots"],["bytes.view","ua"],2]],["let","sl",["std.text.ascii.split_lines_view",["bytes.view","plan"]]],["let","slv",["bytes.view","sl"]],["let","count",["std.text.slices.count_v1","slv"]],["try",["std.test.assert_i32_eq","count",2,["std.test.code_assert_i32_eq"]]],["std.test.pass"]],"kind":"defn","name":"test_pure.plan_max_pages","params":[],"result":"result_i32"},{"body":["begin",["let","prefix",["bytes.lit","https://example.com/"]],["let","input_url",["std.bytes.concat",["bytes.view","prefix"],"b"]],["let","n1",["app.crawl.plan.normalize_url_v1",["bytes.view","input_url"]]],["let","n1_copy",["std.bytes.copy",["bytes.view","n1"]]],["let","n2",["app.crawl.plan.normalize_url_v1",["bytes.view","n1"]]],["let","r",["std.test.assert_bytes_eq","n1_copy","n2",["std.test.code_assert_bytes_eq"]]],["std.test.status_from_result_i32","r"]],"kind":"defn","name":"test_pure.prop_normalize_idempotent","params":[{"name":"b","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","empty",["bytes.lit",""]],["let","ua",["bytes.lit","x07crawl"]],["let","path",["bytes.lit","/page"]],["let","allowed",["app.crawl.plan.is_allowed_v1",["bytes.view","empty"],["bytes.view","ua"],["bytes.view","path"]]],["try",["std.test.assert_i32_eq","allowed",1,["std.test.code_assert_i32_eq"]]],["std.test.pass"]],"kind":"defn","name":"test_pure.robots_empty_allows","params":[],"result":"result_i32"}],"imports":["app.crawl.plan","app.extract","app.util","ext.json.canon","std.bytes","std.fmt","std.test","std.text.ascii","std.text.slices","std.vec"],"kind":"module","module_id":"test_pure","schema_version":"x07.x07ast@0.5.0"}
