{"decls":[{"kind":"export","names":["app.verify.check_fingerprint_v1","app.verify.run_v1"]},{"body":["begin",["let","actual_hex",["app.fingerprint.hex_v1","plan_json"]],["if",["view.eq",["bytes.view","actual_hex"],"expected_hex"],["result_i32.ok",1],["result_i32.err",2]]],"kind":"defn","name":"app.verify.check_fingerprint_v1","params":[{"name":"plan_json","ty":"bytes_view"},{"name":"expected_hex","ty":"bytes_view"}],"result":"result_i32"},{"body":["begin",["let","check",["app.verify.check_fingerprint_v1","plan_json","expected_hex"]],["let","ok",["result_i32.is_ok","check"]],["let","out",["std.vec.with_capacity",256]],["if","ok",["begin",["set","out",["std.vec.extend_bytes","out",["bytes.lit","{\"status\":\"ok\",\"drift\":false,\"fingerprint\":\""]]],["let","fp",["app.fingerprint.hex_v1","plan_json"]],["set","out",["std.vec.extend_bytes","out",["bytes.view","fp"]]],["set","out",["std.vec.extend_bytes","out",["bytes.lit","\"}"]]],0],["begin",["set","out",["std.vec.extend_bytes","out",["bytes.lit","{\"status\":\"drift\",\"drift\":true,\"expected\":\""]]],["set","out",["std.vec.extend_bytes","out","expected_hex"]],["set","out",["std.vec.extend_bytes","out",["bytes.lit","\",\"actual\":\""]]],["let","fp2",["app.fingerprint.hex_v1","plan_json"]],["set","out",["std.vec.extend_bytes","out",["bytes.view","fp2"]]],["set","out",["std.vec.extend_bytes","out",["bytes.lit","\"}"]]],0]],["std.vec.as_bytes","out"]],"kind":"defn","name":"app.verify.run_v1","params":[{"name":"plan_json","ty":"bytes_view"},{"name":"expected_hex","ty":"bytes_view"}],"result":"bytes"}],"imports":["app.fingerprint","std.bytes","std.vec"],"kind":"module","module_id":"app.verify","schema_version":"x07.x07ast@0.5.0"}
