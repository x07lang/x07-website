{"decls":[{"kind":"export","names":["ext.json.data_model.parse"]},{"body":["begin",["let","out",["vec_u8.with_capacity",["+",1,["-","end","start"]]]],["set","out",["vec_u8.push","out",1]],["let","i","start"],["for","_",0,["-","end","start"],["begin",["if",[">=u","i","end"],0,["begin",["let","c",["view.get_u8","b","i"]],["if",["=","c",92],["begin",["if",[">=u",["+","i",1],"end"],["return",["ext.json.data_model._res_err0"]],0],["let","esc",["view.get_u8","b",["+","i",1]]],["if",["=","esc",34],["begin",["set","out",["vec_u8.push","out",34]],["set","i",["+","i",2]],0],0],["if",["=","esc",92],["begin",["set","out",["vec_u8.push","out",92]],["set","i",["+","i",2]],0],0],["if",["=","esc",47],["begin",["set","out",["vec_u8.push","out",47]],["set","i",["+","i",2]],0],0],["if",["=","esc",98],["begin",["set","out",["vec_u8.push","out",8]],["set","i",["+","i",2]],0],0],["if",["=","esc",102],["begin",["set","out",["vec_u8.push","out",12]],["set","i",["+","i",2]],0],0],["if",["=","esc",110],["begin",["set","out",["vec_u8.push","out",10]],["set","i",["+","i",2]],0],0],["if",["=","esc",114],["begin",["set","out",["vec_u8.push","out",13]],["set","i",["+","i",2]],0],0],["if",["=","esc",116],["begin",["set","out",["vec_u8.push","out",9]],["set","i",["+","i",2]],0],0],["if",["=","esc",117],["begin",["if",[">=u",["+","i",5],"end"],["return",["ext.json.data_model._res_err0"]],0],["let","hi",["ext.json.data_model._read_u16_hex4","b",["+","i",2]]],["if",["<","hi",0],["return",["ext.json.data_model._res_err0"]],0],["if",["if",[">=u","hi",55296],["<u","hi",56320],0],["begin",["if",[">=u",["+","i",11],"end"],["return",["ext.json.data_model._res_err0"]],0],["if",["=",["view.get_u8","b",["+","i",6]],92],0,["return",["ext.json.data_model._res_err0"]]],["if",["=",["view.get_u8","b",["+","i",7]],117],0,["return",["ext.json.data_model._res_err0"]]],["let","lo",["ext.json.data_model._read_u16_hex4","b",["+","i",8]]],["if",["if",[">=u","lo",56320],["<u","lo",57344],0],0,["return",["ext.json.data_model._res_err0"]]],["let","cp",["+",65536,["+",["<<u",["-","hi",55296],10],["-","lo",56320]]]],["set","out",["ext.json.data_model._push_utf8","out","cp"]],["set","i",["+","i",12]],0],["begin",["if",["if",[">=u","hi",56320],["<u","hi",57344],0],["return",["ext.json.data_model._res_err0"]],0],["set","out",["ext.json.data_model._push_utf8","out","hi"]],["set","i",["+","i",6]],0]],0],0],["if",["if",["if",["if",["if",["if",["if",["if",["if",["=","esc",34],1,["=","esc",92]],1,["=","esc",47]],1,["=","esc",98]],1,["=","esc",102]],1,["=","esc",110]],1,["=","esc",114]],1,["=","esc",116]],1,["=","esc",117]],0,["return",["ext.json.data_model._res_err0"]]],0],["begin",["set","out",["vec_u8.push","out","c"]],["set","i",["+","i",1]],0]],0]],0]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.json.data_model._decode_string_status","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"}],"result":"bytes"},{"body":["ext.json.data_model._extend_view_range","v","b",0,["view.len","b"]],"kind":"defn","name":"ext.json.data_model._extend_view","params":[{"name":"v","ty":"vec_u8"},{"name":"b","ty":"bytes_view"}],"result":"vec_u8"},{"body":["begin",["let","out","v"],["let","end",["+","start","len"]],["for","i","start","end",["begin",["set","out",["vec_u8.push","out",["view.get_u8","b","i"]]],0]],"out"],"kind":"defn","name":"ext.json.data_model._extend_view_range","params":[{"name":"v","ty":"vec_u8"},{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"len","ty":"i32"}],"result":"vec_u8"},{"body":["begin",["if",["if",[">=u","c",48],["<u","c",58],0],["return",["-","c",48]],0],["if",["if",[">=u","c",65],["<u","c",71],0],["return",["-","c",55]],0],["if",["if",[">=u","c",97],["<u","c",103],0],["return",["-","c",87]],0],-1],"kind":"defn","name":"ext.json.data_model._hex_val","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["let","i",["+","off",1]],["if",[">=u","i","n"],["return",["bytes.alloc",0]],0],["if",["=",["view.get_u8","b","i"],93],["begin",["let","elems",["vec_u8.with_capacity",4]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le",0]]],["let","elems_b",["vec_u8.into_bytes","elems"]],["return",["ext.data_model.value_seq_from_elems",["bytes.view","elems_b"]]]],0],["let","payload",["vec_u8.with_capacity",64]],["let","count",0],["for","_",0,["-","n","off"],["begin",["let","val",["ext.json.data_model._parse_value","b","i"]],["if",["=",["bytes.len","val"],0],["return",["bytes.alloc",0]],0],["set","payload",["vec_u8.extend_bytes","payload",["codec.write_u32_le",["bytes.len","val"]]]],["set","payload",["ext.json.data_model._extend_view","payload",["bytes.view","val"]]],["set","count",["+","count",1]],["let","end",["ext.json.data_model._skip_value","b","i"]],["if",["<","end",0],["return",["bytes.alloc",0]],0],["set","i","end"],["if",[">=u","i","n"],["return",["bytes.alloc",0]],0],["let","d",["view.get_u8","b","i"]],["if",["=","d",44],["set","i",["+","i",1]],["if",["=","d",93],["begin",["let","payload_b",["vec_u8.into_bytes","payload"]],["let","elems",["vec_u8.with_capacity",["+",4,["bytes.len","payload_b"]]]],["set","elems",["vec_u8.extend_bytes","elems",["codec.write_u32_le","count"]]],["set","elems",["ext.json.data_model._extend_view","elems",["bytes.view","payload_b"]]],["let","elems_b",["vec_u8.into_bytes","elems"]],["return",["ext.data_model.value_seq_from_elems",["bytes.view","elems_b"]]]],["return",["bytes.alloc",0]]]],0]],["bytes.alloc",0]],"kind":"defn","name":"ext.json.data_model._parse_array","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","b"]],["let","i",["+","off",1]],["if",[">=u","i","n"],["return",["bytes.alloc",0]],0],["if",["=",["view.get_u8","b","i"],125],["begin",["let","entries",["vec_u8.with_capacity",4]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",0]]],["let","entries_b",["vec_u8.into_bytes","entries"]],["return",["ext.data_model.value_map_from_entries",["bytes.view","entries_b"]]]],0],["let","payload",["vec_u8.with_capacity",96]],["let","count",0],["for","_",0,["-","n","off"],["begin",["if",["=",["view.get_u8","b","i"],34],0,["return",["bytes.alloc",0]]],["let","key_end",["ext.json.data_model._skip_string","b","i"]],["if",["<","key_end",0],["return",["bytes.alloc",0]],0],["let","key_dec",["ext.json.data_model._decode_string_status","b",["+","i",1],["-","key_end",1]]],["let","keyv",["bytes.view","key_dec"]],["if",["=",["bytes.get_u8","key_dec",0],0],["return",["bytes.alloc",0]],0],["let","key_len",["-",["bytes.len","key_dec"],1]],["set","payload",["vec_u8.extend_bytes","payload",["codec.write_u32_le","key_len"]]],["set","payload",["ext.json.data_model._extend_view_range","payload","keyv",1,"key_len"]],["set","i","key_end"],["if",[">=u","i","n"],["return",["bytes.alloc",0]],0],["if",["=",["view.get_u8","b","i"],58],0,["return",["bytes.alloc",0]]],["set","i",["+","i",1]],["let","val",["ext.json.data_model._parse_value","b","i"]],["if",["=",["bytes.len","val"],0],["return",["bytes.alloc",0]],0],["set","payload",["vec_u8.extend_bytes","payload",["codec.write_u32_le",["bytes.len","val"]]]],["set","payload",["ext.json.data_model._extend_view","payload",["bytes.view","val"]]],["set","count",["+","count",1]],["let","end",["ext.json.data_model._skip_value","b","i"]],["if",["<","end",0],["return",["bytes.alloc",0]],0],["set","i","end"],["if",[">=u","i","n"],["return",["bytes.alloc",0]],0],["let","d",["view.get_u8","b","i"]],["if",["=","d",44],["set","i",["+","i",1]],["if",["=","d",125],["begin",["let","payload_b",["vec_u8.into_bytes","payload"]],["let","entries",["vec_u8.with_capacity",["+",4,["bytes.len","payload_b"]]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le","count"]]],["set","entries",["ext.json.data_model._extend_view","entries",["bytes.view","payload_b"]]],["let","entries_b",["vec_u8.into_bytes","entries"]],["let","map_val",["ext.data_model.value_map_from_entries",["bytes.view","entries_b"]]],["if",["=",["bytes.len","map_val"],0],["return",["bytes.alloc",0]],0],["return","map_val"]],["return",["bytes.alloc",0]]]],0]],["bytes.alloc",0]],"kind":"defn","name":"ext.json.data_model._parse_object","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","b"]],["if",[">=u","off","n"],["return",["bytes.alloc",0]],0],["let","c",["view.get_u8","b","off"]],["if",["=","c",34],["begin",["let","end",["ext.json.data_model._skip_string","b","off"]],["if",["<","end",0],["return",["bytes.alloc",0]],0],["let","dec",["ext.json.data_model._decode_string_status","b",["+","off",1],["-","end",1]]],["if",["=",["bytes.get_u8","dec",0],0],["return",["bytes.alloc",0]],0],["let","decv",["bytes.view","dec"]],["let","len",["-",["bytes.len","dec"],1]],["return",["ext.data_model.value_string",["view.slice","decv",1,"len"]]]],0],["if",["=","c",91],["return",["ext.json.data_model._parse_array","b","off"]],0],["if",["=","c",123],["return",["ext.json.data_model._parse_object","b","off"]],0],["if",["=","c",116],["return",["ext.data_model.value_bool",1]],0],["if",["=","c",102],["return",["ext.data_model.value_bool",0]],0],["if",["=","c",110],["return",["ext.data_model.value_null"]],0],["let","end",["ext.json.data_model._skip_number","b","off"]],["if",["<","end","off"],["return",["bytes.alloc",0]],0],["ext.data_model.value_number",["view.slice","b","off",["-","end","off"]]]],"kind":"defn","name":"ext.json.data_model._parse_value","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","o","out"],["if",["<u","cp",128],["return",["vec_u8.push","o","cp"]],0],["if",["<u","cp",2048],["begin",["set","o",["vec_u8.push","o",["|",192,[">>u","cp",6]]]],["set","o",["vec_u8.push","o",["|",128,["&","cp",63]]]],["return","o"]],0],["if",["<u","cp",65536],["begin",["set","o",["vec_u8.push","o",["|",224,[">>u","cp",12]]]],["set","o",["vec_u8.push","o",["|",128,["&",[">>u","cp",6],63]]]],["set","o",["vec_u8.push","o",["|",128,["&","cp",63]]]],["return","o"]],0],["if",["<u","cp",1114112],["begin",["set","o",["vec_u8.push","o",["|",240,[">>u","cp",18]]]],["set","o",["vec_u8.push","o",["|",128,["&",[">>u","cp",12],63]]]],["set","o",["vec_u8.push","o",["|",128,["&",[">>u","cp",6],63]]]],["set","o",["vec_u8.push","o",["|",128,["&","cp",63]]]],["return","o"]],0],"o"],"kind":"defn","name":"ext.json.data_model._push_utf8","params":[{"name":"out","ty":"vec_u8"},{"name":"cp","ty":"i32"}],"result":"vec_u8"},{"body":["begin",["let","n",["view.len","b"]],["if",[">=u",["+","off",3],"n"],["return",-1],0],["let","d0",["ext.json.data_model._hex_val",["view.get_u8","b","off"]]],["let","d1",["ext.json.data_model._hex_val",["view.get_u8","b",["+","off",1]]]],["let","d2",["ext.json.data_model._hex_val",["view.get_u8","b",["+","off",2]]]],["let","d3",["ext.json.data_model._hex_val",["view.get_u8","b",["+","off",3]]]],["if",["<","d0",0],["return",-1],0],["if",["<","d1",0],["return",-1],0],["if",["<","d2",0],["return",-1],0],["if",["<","d3",0],["return",-1],0],["|",["|",["<<u","d0",12],["<<u","d1",8]],["|",["<<u","d2",4],"d3"]]],"kind":"defn","name":"ext.json.data_model._read_u16_hex4","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["begin",["let","b",["bytes.alloc",1]],["bytes.set_u8","b",0,0]],"kind":"defn","name":"ext.json.data_model._res_err0","params":[],"result":"bytes"},{"body":["begin",["let","n",["view.len","b"]],["let","i","off"],["for","_",0,["-","n","off"],["begin",["if",[">=u","i","n"],0,["begin",["let","c",["view.get_u8","b","i"]],["if",["if",["if",["=","c",44],1,["=","c",93]],1,["=","c",125]],["return","i"],0],["set","i",["+","i",1]],0]],0]],"n"],"kind":"defn","name":"ext.json.data_model._skip_number","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["if",[">=u","off","n"],["return",-1],0],["if",["=",["view.get_u8","b","off"],34],0,["return",-1]],["let","i",["+","off",1]],["for","_",0,["-","n","off"],["begin",["if",[">=u","i","n"],0,["begin",["let","c",["view.get_u8","b","i"]],["if",["=","c",34],["return",["+","i",1]],0],["if",["=","c",92],["begin",["if",[">=u",["+","i",1],"n"],["return",-1],0],["if",["=",["view.get_u8","b",["+","i",1]],117],["begin",["if",[">=u",["+","i",5],"n"],["return",-1],0],["set","i",["+","i",6]]],["set","i",["+","i",2]]]],["set","i",["+","i",1]]],0]],0]],-1],"kind":"defn","name":"ext.json.data_model._skip_string","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["if",[">=u","off","n"],["return",-1],0],["let","c",["view.get_u8","b","off"]],["if",["=","c",34],["return",["ext.json.data_model._skip_string","b","off"]],0],["if",["=","c",91],["begin",["let","i",["+","off",1]],["if",[">=u","i","n"],["return",-1],0],["if",["=",["view.get_u8","b","i"],93],["return",["+","i",1]],0],["for","_",0,["-","n","off"],["begin",["let","end",["ext.json.data_model._skip_value","b","i"]],["if",["<","end",0],["return",-1],0],["set","i","end"],["if",[">=u","i","n"],["return",-1],0],["let","d",["view.get_u8","b","i"]],["if",["=","d",44],["set","i",["+","i",1]],["if",["=","d",93],["return",["+","i",1]],["return",-1]]],0]],-1],0],["if",["=","c",123],["begin",["let","i",["+","off",1]],["if",[">=u","i","n"],["return",-1],0],["if",["=",["view.get_u8","b","i"],125],["return",["+","i",1]],0],["for","_",0,["-","n","off"],["begin",["if",["=",["view.get_u8","b","i"],34],0,["return",-1]],["let","key_end",["ext.json.data_model._skip_string","b","i"]],["if",["<","key_end",0],["return",-1],0],["set","i","key_end"],["if",[">=u","i","n"],["return",-1],0],["if",["=",["view.get_u8","b","i"],58],0,["return",-1]],["set","i",["+","i",1]],["let","end",["ext.json.data_model._skip_value","b","i"]],["if",["<","end",0],["return",-1],0],["set","i","end"],["if",[">=u","i","n"],["return",-1],0],["let","d",["view.get_u8","b","i"]],["if",["=","d",44],["set","i",["+","i",1]],["if",["=","d",125],["return",["+","i",1]],["return",-1]]],0]],-1],0],["if",["=","c",116],["if",[">=u",["+","off",3],"n"],-1,["+","off",4]],0],["if",["=","c",102],["if",[">=u",["+","off",4],"n"],-1,["+","off",5]],0],["if",["=","c",110],["if",[">=u",["+","off",3],"n"],-1,["+","off",4]],0],["ext.json.data_model._skip_number","b","off"]],"kind":"defn","name":"ext.json.data_model._skip_value","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["begin",["let","msg_invalid",["bytes.lit","json:invalid"]],["let","msg_parse_failed",["bytes.lit","json:parse_failed"]],["let","msg_trailing",["bytes.lit","json:trailing_bytes"]],["let","canon",["ext.json.canon.canonicalize","json"]],["let","canon_len",["bytes.len","canon"]],["if",["=","canon_len",0],["return",["ext.data_model.doc_err_from_msg",["bytes.view","msg_invalid"]]],0],["let","canonv",["bytes.view","canon"]],["let","val",["ext.json.data_model._parse_value","canonv",0]],["if",["=",["bytes.len","val"],0],["return",["ext.data_model.doc_err_from_msg",["bytes.view","msg_parse_failed"]]],0],["let","end",["ext.json.data_model._skip_value","canonv",0]],["if",["=","end",["view.len","canonv"]],0,["return",["ext.data_model.doc_err_from_msg",["bytes.view","msg_trailing"]]]],["ext.data_model.doc_ok",["bytes.view","val"]]],"kind":"defn","name":"ext.json.data_model.parse","params":[{"name":"json","ty":"bytes_view"}],"result":"bytes"}],"imports":["ext.data_model","ext.json.canon"],"kind":"module","module_id":"ext.json.data_model","schema_version":"x07.x07ast@0.3.0"}
