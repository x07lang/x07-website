{"decls":[{"kind":"export","names":["app.crawl.plan._lines_contains_v1","app.crawl.plan.dedupe_urls_v1","app.crawl.plan.is_allowed_v1","app.crawl.plan.normalize_url_v1","app.crawl.plan.plan_crawl_v1"]},{"body":["begin",["let","sl",["std.text.ascii.split_lines_view","lines"]],["let","slv",["bytes.view","sl"]],["let","count",["std.text.slices.count_v1","slv"]],["for","i",0,"count",["begin",["let","v",["std.text.slices.view_at_v1","lines","slv","i"]],["if",["=",["view.len","v"],0],0,["if",["=",["view.eq","v","needle"],1],["return",1],0]],0]],0],"kind":"defn","name":"app.crawl.plan._lines_contains_v1","params":[{"name":"lines","ty":"bytes_view"},{"name":"needle","ty":"bytes_view"}],"result":"i32"},{"body":["std.set.unique_lines_sorted","urls"],"kind":"defn","name":"app.crawl.plan.dedupe_urls_v1","params":[{"name":"urls","ty":"bytes_view"}],"result":"bytes"},{"body":["std.crawl.robots.allowed_v1","robots_rules","user_agent","url_path"],"kind":"defn","name":"app.crawl.plan.is_allowed_v1","params":[{"name":"robots_rules","ty":"bytes_view"},{"name":"user_agent","ty":"bytes_view"},{"name":"url_path","ty":"bytes_view"}],"result":"i32"},{"body":["std.crawl.urlnorm.canon_v1","url"],"ensures":[{"expr":[">",["view.len",["bytes.view","__result"]],0],"id":"output_nonempty"}],"kind":"defn","name":"app.crawl.plan.normalize_url_v1","params":[{"name":"url","ty":"bytes_view"}],"requires":[{"expr":[">",["view.len","url"],0],"id":"url_nonempty"}],"result":"bytes"},{"body":["begin",["let","sl",["std.text.ascii.split_lines_view","seeds"]],["let","slv",["bytes.view","sl"]],["let","count",["std.text.slices.count_v1","slv"]],["let","out",["std.vec.with_capacity",2048]],["let","seen",["std.vec.with_capacity",2048]],["let","added",0],["for","i",0,"count",["begin",["if",[">=","added","max_pages"],["return",["std.vec.as_bytes","out"]],0],["let","raw_url",["std.text.slices.view_at_v1","seeds","slv","i"]],["if",["=",["view.len","raw_url"],0],0,["begin",["let","norm",["app.crawl.plan.normalize_url_v1","raw_url"]],["let","norm_v",["bytes.view","norm"]],["if",["=",["app.crawl.plan._lines_contains_v1",["vec_u8.as_view","seen"],"norm_v"],1],0,["begin",["set","seen",["std.vec.extend_bytes","seen","norm_v"]],["set","seen",["std.vec.push","seen",10]],["if",[">","added",0],["set","out",["std.vec.push","out",10]],0],["set","out",["std.vec.extend_bytes","out","norm_v"]],["set","added",["+","added",1]],0]],0]],0]],["std.vec.as_bytes","out"]],"kind":"defn","name":"app.crawl.plan.plan_crawl_v1","params":[{"name":"seeds","ty":"bytes_view"},{"name":"robots_rules","ty":"bytes_view"},{"name":"user_agent","ty":"bytes_view"},{"name":"max_pages","ty":"i32"}],"result":"bytes"}],"imports":["std.bytes","std.crawl.robots","std.crawl.urlnorm","std.set","std.text.ascii","std.text.slices","std.vec"],"kind":"module","module_id":"app.crawl.plan","schema_version":"x07.x07ast@0.5.0"}
