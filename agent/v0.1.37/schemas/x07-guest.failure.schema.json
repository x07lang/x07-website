{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://x07.io/spec/x07-guest.failure.schema.json",
  "title": "x07 guest failure artifact (v0.1.0)",
  "type": "object",
  "additionalProperties": false,
  "required": ["schema_version", "run_id", "failure_kind", "stage", "when_unix_ms", "message"],
  "properties": {
    "schema_version": { "const": "x07.guest.failure@0.1.0" },
    "run_id": { "type": "string", "minLength": 1, "maxLength": 128 },
    "failure_kind": { "const": "mount_failed" },
    "stage": {
      "type": "string",
      "enum": [
        "mount_x07out",
        "mount_x07in",
        "mount_tag",
        "bind_mount",
        "remount_ro"
      ]
    },
    "when_unix_ms": { "type": "integer", "minimum": 0 },
    "tag": {
      "type": ["string", "null"],
      "pattern": "^x07(out|in|m([0-9]|[1-5][0-9]|6[0-3]))$",
      "default": null
    },
    "mountpoint": {
      "type": ["string", "null"],
      "pattern": "^/[^\\u0000]*$",
      "default": null
    },
    "guest_path": {
      "type": ["string", "null"],
      "pattern": "^/[^\\u0000]*$",
      "default": null
    },
    "readonly": { "type": ["boolean", "null"], "default": null },
    "errno": { "type": ["integer", "null"], "default": null },
    "message": { "type": "string", "minLength": 1, "maxLength": 4096 },
    "detail": { "type": ["string", "null"], "maxLength": 65536, "default": null }
  }
}

