{"decls":[{"kind":"export","names":["unit.fingerprint_deterministic","unit.fingerprint_nonempty","unit.plan_outputs_json","unit.stable_unique_duplicate","unit.stable_unique_sorted","unit.verify_drift_detected","unit.verify_no_drift"]},{"body":["begin",["let","plan",["bytes.lit","{\"id\":\"test\",\"v\":1}"]],["let","fp1",["app.fingerprint.hex_v1",["bytes.view","plan"]]],["let","plan2",["bytes.lit","{\"id\":\"test\",\"v\":1}"]],["let","fp2",["app.fingerprint.hex_v1",["bytes.view","plan2"]]],["std.test.assert_bytes_eq","fp1","fp2",101]],"kind":"defn","name":"unit.fingerprint_deterministic","params":[],"result":"result_i32"},{"body":["begin",["let","plan",["bytes.lit","{\"id\":\"test\"}"]],["let","fp",["app.fingerprint.hex_v1",["bytes.view","plan"]]],["std.test.assert_true",[">",["std.bytes.len","fp"],0],102]],"kind":"defn","name":"unit.fingerprint_nonempty","params":[],"result":"result_i32"},{"body":["begin",["let","plan",["bytes.lit","{\"id\":\"test\",\"v\":1}"]],["let","output",["app.plan.run_v1",["bytes.view","plan"]]],["std.test.assert_true",["=",["std.bytes.get_u8","output",0],123],103]],"kind":"defn","name":"unit.plan_outputs_json","params":[],"result":"result_i32"},{"body":["begin",["let","v",["std.vec.with_capacity",12]],["set","v",["std.vec.extend_bytes","v",["std.codec.write_u32_le",1]]],["set","v",["std.vec.extend_bytes","v",["std.codec.write_u32_le",1]]],["set","v",["std.vec.extend_bytes","v",["std.codec.write_u32_le",2]]],["let","data",["std.vec.as_bytes","v"]],["let","result",["tapp","app.util.stable_unique","u32",["bytes.view","data"],3]],["std.test.assert_true",["=",["result_i32.is_ok","result"],0],107]],"kind":"defn","name":"unit.stable_unique_duplicate","params":[],"result":"result_i32"},{"body":["begin",["let","v",["std.vec.with_capacity",12]],["set","v",["std.vec.extend_bytes","v",["std.codec.write_u32_le",1]]],["set","v",["std.vec.extend_bytes","v",["std.codec.write_u32_le",2]]],["set","v",["std.vec.extend_bytes","v",["std.codec.write_u32_le",3]]],["let","data",["std.vec.as_bytes","v"]],["let","result",["tapp","app.util.stable_unique","u32",["bytes.view","data"],3]],["std.test.assert_true",["result_i32.is_ok","result"],106]],"kind":"defn","name":"unit.stable_unique_sorted","params":[],"result":"result_i32"},{"body":["begin",["let","plan",["bytes.lit","{\"id\":\"test\",\"v\":1}"]],["let","wrong_fp",["bytes.lit","00000000"]],["let","result",["app.verify.run_v1",["bytes.view","plan"],["bytes.view","wrong_fp"]]],["std.test.assert_true",["std.bytes.starts_with",["bytes.view","result"],["bytes.lit","{\"status\":\"drift\""]],105]],"kind":"defn","name":"unit.verify_drift_detected","params":[],"result":"result_i32"},{"body":["begin",["let","plan",["bytes.lit","{\"id\":\"test\",\"v\":1}"]],["let","fp",["app.fingerprint.hex_v1",["bytes.view","plan"]]],["let","result",["app.verify.run_v1",["bytes.view","plan"],["bytes.view","fp"]]],["std.test.assert_true",["std.bytes.starts_with",["bytes.view","result"],["bytes.lit","{\"status\":\"ok\""]],104]],"kind":"defn","name":"unit.verify_no_drift","params":[],"result":"result_i32"}],"imports":["app.fingerprint","app.plan","app.util","app.verify","std.bytes","std.codec","std.test","std.vec"],"kind":"module","module_id":"unit","schema_version":"x07.x07ast@0.5.0"}
