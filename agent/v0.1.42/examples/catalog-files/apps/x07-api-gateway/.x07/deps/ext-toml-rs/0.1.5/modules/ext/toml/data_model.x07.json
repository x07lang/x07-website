{"decls":[{"kind":"export","names":["ext.toml.data_model.parse"]},{"body":["ext.data_model.doc_err_from_msg","msg"],"kind":"defn","name":"ext.toml.data_model._err","params":[{"name":"msg","ty":"bytes_view"}],"result":"bytes"},{"body":["ext.toml.data_model._extend_view_range","v","b",0,["view.len","b"]],"kind":"defn","name":"ext.toml.data_model._extend_view","params":[{"name":"v","ty":"vec_u8"},{"name":"b","ty":"bytes_view"}],"result":"vec_u8"},{"body":["begin",["let","out","v"],["let","end",["+","start","len"]],["for","i","start","end",["begin",["set","out",["vec_u8.push","out",["view.get_u8","b","i"]]],0]],"out"],"kind":"defn","name":"ext.toml.data_model._extend_view_range","params":[{"name":"v","ty":"vec_u8"},{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"len","ty":"i32"}],"result":"vec_u8"},{"body":["begin",["let","msg_malformed",["bytes.lit","toml:malformed_doc"]],["let","msg_decode_failed",["bytes.lit","toml:decode_failed"]],["let","msg_map_failed",["bytes.lit","toml:map_build_failed"]],["let","raw",["ext.toml.toml_parse","src"]],["if",["=",["ext.toml.toml_is_err",["bytes.view","raw"]],1],["return","raw"],0],["let","rawv",["bytes.view","raw"]],["let","n",["view.len","rawv"]],["if",["<","n",5],["return",["ext.toml.data_model._err",["bytes.view","msg_malformed"]]],0],["let","count",["codec.read_u32_le","rawv",1]],["let","entries",["vec_u8.with_capacity",["+",4,"n"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le","count"]]],["let","pos",5],["let","ok",1],["for","_",0,"count",["begin",["if",["=","ok",0],0,["begin",["if",[">=u",["+","pos",4],["+","n",1]],["set","ok",0],0],["if",["=","ok",0],0,["begin",["let","key_len",["codec.read_u32_le","rawv","pos"]],["set","pos",["+","pos",4]],["if",[">=u",["+","pos","key_len"],["+","n",1]],["set","ok",0],0],["if",["=","ok",0],0,["begin",["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le","key_len"]]],["set","entries",["ext.toml.data_model._extend_view_range","entries","rawv","pos","key_len"]],["set","pos",["+","pos","key_len"]],["if",[">=u","pos","n"],["set","ok",0],0],["if",["=","ok",0],0,["begin",["let","vtype",["view.get_u8","rawv","pos"]],["set","pos",["+","pos",1]],["let","val",["bytes.alloc",0]],["if",["=","vtype",1],["begin",["if",[">=u",["+","pos",4],["+","n",1]],["set","ok",0],0],["if",["=","ok",0],0,["begin",["let","vlen",["codec.read_u32_le","rawv","pos"]],["set","pos",["+","pos",4]],["if",[">=u",["+","pos","vlen"],["+","n",1]],["set","ok",0],0],["if",["=","ok",0],0,["begin",["let","s",["view.slice","rawv","pos","vlen"]],["set","val",["ext.data_model.value_string","s"]],["set","pos",["+","pos","vlen"]],0]]]]],0],["if",["=","vtype",2],["begin",["if",[">=u",["+","pos",4],["+","n",1]],["set","ok",0],0],["if",["=","ok",0],0,["begin",["let","x",["codec.read_u32_le","rawv","pos"]],["set","pos",["+","pos",4]],["let","x_s",["std.fmt.s32_to_dec","x"]],["set","val",["ext.data_model.value_number",["bytes.view","x_s"]]],0]]],0],["if",["=","vtype",3],["begin",["if",[">=u","pos","n"],["set","ok",0],0],["if",["=","ok",0],0,["begin",["let","b",["view.get_u8","rawv","pos"]],["set","pos",["+","pos",1]],["set","val",["ext.data_model.value_bool","b"]],0]]],0],["if",["if",["if",["=","vtype",1],1,["=","vtype",2]],1,["=","vtype",3]],0,["set","ok",0]],["if",["=","ok",0],0,["begin",["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["bytes.len","val"]]]],["set","entries",["ext.toml.data_model._extend_view","entries",["bytes.view","val"]]],0]],0]],0]]]],0]],0]],["if",["=","ok",0],["return",["ext.toml.data_model._err",["bytes.view","msg_decode_failed"]]],0],["let","entries_b",["vec_u8.into_bytes","entries"]],["let","map_val",["ext.data_model.value_map_from_entries",["bytes.view","entries_b"]]],["if",["=",["bytes.len","map_val"],0],["return",["ext.toml.data_model._err",["bytes.view","msg_map_failed"]]],0],["ext.data_model.doc_ok",["bytes.view","map_val"]]],"kind":"defn","name":"ext.toml.data_model.parse","params":[{"name":"src","ty":"bytes_view"}],"result":"bytes"}],"imports":["ext.data_model","ext.toml","std.fmt"],"kind":"module","module_id":"ext.toml.data_model","schema_version":"x07.x07ast@0.3.0"}
