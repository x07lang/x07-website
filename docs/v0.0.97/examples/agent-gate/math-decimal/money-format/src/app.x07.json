{"decls":[{"kind":"export","names":["app.solve"]},{"body":["begin",["let","n",["view.len","v"]],["for","i",0,"n",["if",["=",["view.get_u8","v","i"],46],["return","i"],0]],-1],"kind":"defn","name":"app._find_dot","params":[{"name":"v","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","doc",["std.math.decimal.fmt.format_dec_v1","dec"]],["let","dot00",["bytes.lit",".00"]],["let","zeros",["bytes.lit","00"]],["if",["!=",["std.math.decimal.fmt.is_err",["bytes.view","doc"]],0],["return",["bytes.lit","<fmt_err>"]],0],["let","s",["std.math.decimal.fmt.get_bytes",["bytes.view","doc"]]],["let","n",["bytes.len","s"]],["let","dot",["app._find_dot",["bytes.view","s"]]],["if",["<","dot",0],["begin",["let","out",["std.vec.with_capacity",["+","n",3]]],["set","out",["std.vec.extend_bytes","out",["bytes.view","s"]]],["set","out",["std.vec.extend_bytes","out",["bytes.view","dot00"]]],["return",["std.vec.as_bytes","out"]],0],0],["let","frac",["-",["-","n","dot"],1]],["if",[">","frac",2],["return",["bytes.lit","<scale_gt_2>"]],0],["if",["=","frac",2],["return","s"],0],["let","out",["std.vec.with_capacity",["+","n",1]]],["set","out",["std.vec.extend_bytes","out",["bytes.view","s"]]],["if",["=","frac",1],["set","out",["std.vec.push","out",48]],["set","out",["std.vec.extend_bytes","out",["bytes.view","zeros"]]]],["std.vec.as_bytes","out"]],"kind":"defn","name":"app.money_format_2dp","params":[{"name":"dec","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","price_s",["bytes.lit","19.99"]],["let","tax_s",["bytes.lit","0.01"]],["let","pdoc",["std.math.decimal.parse.parse_dec_v1",["bytes.view","price_s"]]],["if",["!=",["std.math.decimal.parse.is_err",["bytes.view","pdoc"]],0],["return",["bytes.lit","FAIL_parse_price"]],0],["let","price",["std.math.decimal.parse.get_bytes",["bytes.view","pdoc"]]],["let","tdoc",["std.math.decimal.parse.parse_dec_v1",["bytes.view","tax_s"]]],["if",["!=",["std.math.decimal.parse.is_err",["bytes.view","tdoc"]],0],["return",["bytes.lit","FAIL_parse_tax"]],0],["let","tax",["std.math.decimal.parse.get_bytes",["bytes.view","tdoc"]]],["let","total",["std.math.decimal.add_v1",["bytes.view","price"],["bytes.view","tax"]]],["let","money",["app.money_format_2dp",["bytes.view","total"]]],["if",["=",["bytes.eq","money",["bytes.lit","20.00"]],0],["return",["bytes.lit","FAIL_money"]],0],["let","out",["bytes.alloc",3]],["set","out",["bytes.set_u8","out",0,111]],["set","out",["bytes.set_u8","out",1,107]],["bytes.set_u8","out",2,10]],"kind":"defn","name":"app.solve","params":[{"name":"b","ty":"bytes_view"}],"result":"bytes"}],"imports":["std.math.decimal","std.math.decimal.fmt","std.math.decimal.parse","std.vec"],"kind":"module","module_id":"app","schema_version":"x07.x07ast@0.3.0"}
