{"decls":[{"kind":"export","names":["app.solve"]},{"body":["begin",["let","spec",["bytes.lit","{\"schema_version\":\"x07cli.specrows@0.1.0\",\"app\":{\"name\":\"x07crawl\",\"version\":\"0.1.0\"},\"rows\":[[\"root\",\"opt\",\"\",\"--mode\",\"mode\",\"MODE\",\"record or replay\",{\"required\":true}],[\"root\",\"opt\",\"\",\"--seeds\",\"seeds\",\"SEEDS\",\"newline-separated seed URLs\",{\"required\":false}],[\"root\",\"opt\",\"\",\"--out\",\"out\",\"PATH\",\"output path\",{\"required\":true}]]}"]],["let","argv_v1",["view.to_bytes","b"]],["let","doc",["ext.cli.parse_specrows","spec","argv_v1"]],["begin",["let","_x07_tmp_copy",["view.to_bytes","doc"]],["if",["=",["ext.cli.is_ok",["bytes.view","_x07_tmp_copy"]],0],["return",["ext.cli.err_usage",["bytes.view","doc"]]],0]],["let","k_mode",["bytes.lit","mode"]],["let","k_seeds",["bytes.lit","seeds"]],["let","k_out",["bytes.lit","out"]],["let","mode",["option_bytes.unwrap_or",["ext.cli.matches_get",["bytes.view","doc"],["bytes.view","k_mode"],2],["bytes.alloc",0]]],["let","default_seeds",["bytes.lit","https://example.com/\nhttps://example.com/sitemap.xml\nhttps://example.com/robots.txt"]],["let","seeds_arg",["option_bytes.unwrap_or",["ext.cli.matches_get",["bytes.view","doc"],["bytes.view","k_seeds"],2],"default_seeds"]],["let","out_path",["option_bytes.unwrap_or",["ext.cli.matches_get",["bytes.view","doc"],["bytes.view","k_out"],2],["bytes.alloc",0]]],["let","mode_record",["bytes.lit","record"]],["let","mode_replay",["bytes.lit","replay"]],["let","is_record",["std.bytes.eq",["bytes.view","mode"],["bytes.view","mode_record"]]],["let","is_replay",["std.bytes.eq",["bytes.view","mode"],["bytes.view","mode_replay"]]],["if",["=",["|","is_record","is_replay"],0],["return",["bytes.lit","ERROR: --mode must be 'record' or 'replay'"]],0],["let","user_agent",["bytes.lit","x07crawl/0.1.0"]],["let","empty_robots",["bytes.lit",""]],["let","plan",["app.crawl.plan.plan_crawl_v1",["bytes.view","seeds_arg"],["bytes.view","empty_robots"],["bytes.view","user_agent"],3]],["let","j_open",["bytes.lit","{\"mode\":\""]],["let","j_plan",["bytes.lit","\",\"plan_urls\":"]],["let","j_out",["bytes.lit",",\"output\":\""]],["let","j_close",["bytes.lit","\"}"]],["let","out_v",["std.vec.with_capacity",2048]],["set","out_v",["std.vec.extend_bytes","out_v",["bytes.view","j_open"]]],["set","out_v",["std.vec.extend_bytes","out_v",["bytes.view","mode"]]],["set","out_v",["std.vec.extend_bytes","out_v",["bytes.view","j_plan"]]],["let","plan_sl",["std.text.ascii.split_lines_view",["bytes.view","plan"]]],["let","plan_slv",["bytes.view","plan_sl"]],["let","plan_count",["std.text.slices.count_v1","plan_slv"]],["let","count_b",["std.fmt.u32_to_dec","plan_count"]],["set","out_v",["std.vec.extend_bytes","out_v",["bytes.view","count_b"]]],["set","out_v",["std.vec.extend_bytes","out_v",["bytes.view","j_out"]]],["set","out_v",["std.vec.extend_bytes","out_v",["bytes.view","out_path"]]],["set","out_v",["std.vec.extend_bytes","out_v",["bytes.view","j_close"]]],["let","raw_json",["std.vec.as_bytes","out_v"]],["let","canonical",["ext.json.canon.canonicalize",["bytes.view","raw_json"]]],"canonical"],"kind":"defn","name":"app.solve","params":[{"name":"b","ty":"bytes_view"}],"result":"bytes"}],"imports":["app.crawl.plan","app.extract","app.util","ext.cli","ext.json.canon","std.bytes","std.fmt","std.text.ascii","std.text.slices","std.vec"],"kind":"module","module_id":"app","schema_version":"x07.x07ast@0.5.0"}
