{"decls":[{"kind":"export","names":["ext.json.pointer.pointer_exists","ext.json.pointer.pointer_get","ext.json.pointer.pointer_get_string","ext.json.pointer.pointer_resolve"]},{"body":["begin",["let","a_len",["view.len","a"]],["let","b_len",["view.len","b"]],["if",["=",["=","a_len","b_len"],0],["return",0],0],["for","i",0,"a_len",["if",["=",["=",["view.get_u8","a","i"],["view.get_u8","b","i"]],0],["return",0],0]],1],"kind":"defn","name":"ext.json.pointer._bytes_eq","params":[{"name":"a","ty":"bytes_view"},{"name":"b","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","n",["view.len","json"]],["if",[">=u","pos","n"],["return",["vec_u8.into_bytes",["vec_u8.with_capacity",0]]],0],["if",["=",["=",["view.get_u8","json","pos"],34],0],["return",["vec_u8.into_bytes",["vec_u8.with_capacity",0]]],0],["let","out",["vec_u8.with_capacity",64]],["let","i",["+","pos",1]],["for","_",["+","pos",1],"n",["if",["<u","i","n"],["begin",["let","c",["view.get_u8","json","i"]],["if",["=","c",34],["return",["vec_u8.into_bytes","out"]],0],["if",["=","c",92],["if",["<u",["+","i",1],"n"],["begin",["let","esc",["view.get_u8","json",["+","i",1]]],["if",["=","esc",110],["set","out",["vec_u8.push","out",10]],["if",["=","esc",116],["set","out",["vec_u8.push","out",9]],["if",["=","esc",114],["set","out",["vec_u8.push","out",13]],["if",["=","esc",92],["set","out",["vec_u8.push","out",92]],["if",["=","esc",34],["set","out",["vec_u8.push","out",34]],["if",["=","esc",47],["set","out",["vec_u8.push","out",47]],["set","out",["vec_u8.push","out","esc"]]]]]]]],["set","i",["+","i",2]]],["set","i",["+","i",1]]],["begin",["set","out",["vec_u8.push","out","c"]],["set","i",["+","i",1]]]]],0]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.json.pointer._extract_string","params":[{"name":"json","ty":"bytes_view"},{"name":"pos","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","ptr"]],["let","i","start"],["let","found",["-",0,1]],["for","_","start","n",["if",["<u","i","n"],["if",["<","found",0],["begin",["if",["=",["view.get_u8","ptr","i"],47],["set","found","i"],0],["set","i",["+","i",1]]],0],0]],["if",["<","found",0],"n","found"]],"kind":"defn","name":"ext.json.pointer._find_slash","params":[{"name":"ptr","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","json"]],["let","i",["ext.json.pointer._skip_ws","json",["+","arr_start",1]]],["if",[">=u","i","n"],["return",["-",0,1]],0],["if",["=",["view.get_u8","json","i"],93],["return",["-",0,1]],0],["let","idx",0],["for","_",0,"n",["if",["<u","i","n"],["begin",["if",["=","idx","index"],["return","i"],0],["let","end",["ext.json.pointer._skip_value","json","i"]],["set","i",["ext.json.pointer._skip_ws","json","end"]],["if",[">=u","i","n"],["return",["-",0,1]],0],["let","c",["view.get_u8","json","i"]],["if",["=","c",93],["return",["-",0,1]],0],["if",["=","c",44],["begin",["set","i",["ext.json.pointer._skip_ws","json",["+","i",1]]],["set","idx",["+","idx",1]]],0]],0]],["-",0,1]],"kind":"defn","name":"ext.json.pointer._get_array_element","params":[{"name":"json","ty":"bytes_view"},{"name":"arr_start","ty":"i32"},{"name":"index","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","json"]],["let","i",["ext.json.pointer._skip_ws","json",["+","obj_start",1]]],["if",[">=u","i","n"],["return",["-",0,1]],0],["if",["=",["view.get_u8","json","i"],125],["return",["-",0,1]],0],["for","_",0,"n",["if",["<u","i","n"],["begin",["if",["=",["=",["view.get_u8","json","i"],34],0],["return",["-",0,1]],0],["let","key_str",["ext.json.pointer._extract_string","json","i"]],["let","key_view",["bytes.view","key_str"]],["let","key_match",["ext.json.pointer._bytes_eq","key_view","key"]],["set","i",["ext.json.pointer._skip_string","json","i"]],["set","i",["ext.json.pointer._skip_ws","json","i"]],["if",[">=u","i","n"],["return",["-",0,1]],0],["if",["=",["=",["view.get_u8","json","i"],58],0],["return",["-",0,1]],0],["set","i",["ext.json.pointer._skip_ws","json",["+","i",1]]],["if",["=","key_match",1],["return","i"],0],["set","i",["ext.json.pointer._skip_value","json","i"]],["set","i",["ext.json.pointer._skip_ws","json","i"]],["if",[">=u","i","n"],["return",["-",0,1]],0],["let","c",["view.get_u8","json","i"]],["if",["=","c",125],["return",["-",0,1]],0],["if",["=","c",44],["set","i",["ext.json.pointer._skip_ws","json",["+","i",1]]],0]],0]],["-",0,1]],"kind":"defn","name":"ext.json.pointer._get_object_member","params":[{"name":"json","ty":"bytes_view"},{"name":"obj_start","ty":"i32"},{"name":"key","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","n",["view.len","seg"]],["if",["=","n",0],["return",["-",0,1]],0],["if",[">","n",1],["if",["=",["view.get_u8","seg",0],48],["return",["-",0,1]],0],0],["let","val",0],["for","i",0,"n",["begin",["let","c",["view.get_u8","seg","i"]],["if",["<u","c",48],["return",["-",0,1]],0],["if",[">=u","c",58],["return",["-",0,1]],0],["set","val",["+",["*","val",10],["-","c",48]]]]],"val"],"kind":"defn","name":"ext.json.pointer._parse_index","params":[{"name":"seg","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","n",["view.len","json"]],["if",[">=u","pos","n"],["return","pos"],0],["if",["=",["=",["view.get_u8","json","pos"],34],0],["return","pos"],0],["let","i",["+","pos",1]],["for","_",["+","pos",1],"n",["if",["<u","i","n"],["begin",["let","c",["view.get_u8","json","i"]],["if",["=","c",34],["return",["+","i",1]],0],["if",["=","c",92],["set","i",["+","i",2]],["set","i",["+","i",1]]]],0]],"n"],"kind":"defn","name":"ext.json.pointer._skip_string","params":[{"name":"json","ty":"bytes_view"},{"name":"pos","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","json"]],["let","i",["ext.json.pointer._skip_ws","json","pos"]],["if",[">=u","i","n"],["return","n"],0],["let","c",["view.get_u8","json","i"]],["if",["=","c",34],["return",["ext.json.pointer._skip_string","json","i"]],0],["if",["=","c",123],["begin",["let","j",["+","i",1]],["let","depth",1],["for","_",["+","i",1],"n",["if",["<u","j","n"],["if",[">","depth",0],["begin",["let","ch",["view.get_u8","json","j"]],["if",["=","ch",123],["begin",["set","depth",["+","depth",1]],["set","j",["+","j",1]]],["if",["=","ch",125],["begin",["set","depth",["-","depth",1]],["set","j",["+","j",1]]],["if",["=","ch",34],["set","j",["ext.json.pointer._skip_string","json","j"]],["set","j",["+","j",1]]]]]],0],0]],["return","j"]],0],["if",["=","c",91],["begin",["let","j",["+","i",1]],["let","depth",1],["for","_",["+","i",1],"n",["if",["<u","j","n"],["if",[">","depth",0],["begin",["let","ch",["view.get_u8","json","j"]],["if",["=","ch",91],["begin",["set","depth",["+","depth",1]],["set","j",["+","j",1]]],["if",["=","ch",93],["begin",["set","depth",["-","depth",1]],["set","j",["+","j",1]]],["if",["=","ch",34],["set","j",["ext.json.pointer._skip_string","json","j"]],["set","j",["+","j",1]]]]]],0],0]],["return","j"]],0],["let","j","i"],["for","_","i","n",["if",["<u","j","n"],["begin",["let","ch",["view.get_u8","json","j"]],["if",["if",["if",["if",["if",["if",["if",["=","ch",44],1,["=","ch",125]],1,["=","ch",93]],1,["=","ch",32]],1,["=","ch",9]],1,["=","ch",10]],1,["=","ch",13]],["return","j"],0],["set","j",["+","j",1]]],0]],"n"],"kind":"defn","name":"ext.json.pointer._skip_value","params":[{"name":"json","ty":"bytes_view"},{"name":"pos","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","json"]],["let","i","pos"],["for","_","pos","n",["if",["<u","i","n"],["begin",["let","c",["view.get_u8","json","i"]],["if",["if",["if",["if",["=","c",32],1,["=","c",9]],1,["=","c",10]],1,["=","c",13]],["set","i",["+","i",1]],0]],0]],"i"],"kind":"defn","name":"ext.json.pointer._skip_ws","params":[{"name":"json","ty":"bytes_view"},{"name":"pos","ty":"i32"}],"result":"i32"},{"body":["begin",["let","len",["-","end","start"]],["let","out",["vec_u8.with_capacity","len"]],["let","i","start"],["for","_","start","end",["if",["<u","i","end"],["begin",["let","c",["view.get_u8","seg","i"]],["if",["=","c",126],["if",["<u",["+","i",1],"end"],["begin",["let","next",["view.get_u8","seg",["+","i",1]]],["if",["=","next",48],["begin",["set","out",["vec_u8.push","out",126]],["set","i",["+","i",2]]],["if",["=","next",49],["begin",["set","out",["vec_u8.push","out",47]],["set","i",["+","i",2]]],["begin",["set","out",["vec_u8.push","out","c"]],["set","i",["+","i",1]]]]]],["begin",["set","out",["vec_u8.push","out","c"]],["set","i",["+","i",1]]]],["begin",["set","out",["vec_u8.push","out","c"]],["set","i",["+","i",1]]]]],0]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.json.pointer._unescape_segment","params":[{"name":"seg","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","pos",["ext.json.pointer.pointer_resolve","json","ptr"]],["if",["<","pos",0],0,1]],"kind":"defn","name":"ext.json.pointer.pointer_exists","params":[{"name":"json","ty":"bytes_view"},{"name":"ptr","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","pos",["ext.json.pointer.pointer_resolve","json","ptr"]],["if",["<","pos",0],["return",["vec_u8.into_bytes",["vec_u8.with_capacity",0]]],0],["let","end",["ext.json.pointer._skip_value","json","pos"]],["let","len",["-","end","pos"]],["let","out",["vec_u8.with_capacity","len"]],["for","i","pos","end",["set","out",["vec_u8.push","out",["view.get_u8","json","i"]]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.json.pointer.pointer_get","params":[{"name":"json","ty":"bytes_view"},{"name":"ptr","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","pos",["ext.json.pointer.pointer_resolve","json","ptr"]],["if",["<","pos",0],["return",["vec_u8.into_bytes",["vec_u8.with_capacity",0]]],0],["ext.json.pointer._extract_string","json","pos"]],"kind":"defn","name":"ext.json.pointer.pointer_get_string","params":[{"name":"json","ty":"bytes_view"},{"name":"ptr","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","ptr_len",["view.len","ptr"]],["let","json_len",["view.len","json"]],["if",["=","ptr_len",0],["return",["ext.json.pointer._skip_ws","json",0]],0],["if",["=",["=",["view.get_u8","ptr",0],47],0],["return",["-",0,1]],0],["let","pos",["ext.json.pointer._skip_ws","json",0]],["let","seg_start",1],["for","_",0,"ptr_len",["if",["<u","seg_start","ptr_len"],["begin",["let","seg_end",["ext.json.pointer._find_slash","ptr","seg_start"]],["let","seg",["ext.json.pointer._unescape_segment","ptr","seg_start","seg_end"]],["let","seg_view",["bytes.view","seg"]],["if",[">=u","pos","json_len"],["return",["-",0,1]],0],["let","c",["view.get_u8","json","pos"]],["if",["=","c",123],["begin",["set","pos",["ext.json.pointer._get_object_member","json","pos","seg_view"]],["if",["<","pos",0],["return",["-",0,1]],0]],["if",["=","c",91],["begin",["let","idx",["ext.json.pointer._parse_index","seg_view"]],["if",["<","idx",0],["return",["-",0,1]],0],["set","pos",["ext.json.pointer._get_array_element","json","pos","idx"]],["if",["<","pos",0],["return",["-",0,1]],0]],["return",["-",0,1]]]],["set","seg_start",["+","seg_end",1]]],0]],"pos"],"kind":"defn","name":"ext.json.pointer.pointer_resolve","params":[{"name":"json","ty":"bytes_view"},{"name":"ptr","ty":"bytes_view"}],"result":"i32"}],"imports":[],"kind":"module","meta":{"generated_by":"x07import","source_path":"tests/x07import/fixtures/import_sources/rust/ext_json@0.1.0/pointer.rs","source_sha256":"af033d64890f287b7beef6e36f765c896dba8bb80fb1d09ae4893eceff8a10f9"},"module_id":"ext.json.pointer","schema_version":"x07.x07ast@0.3.0"}
