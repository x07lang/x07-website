{"decls":[{"kind":"export","names":["app.gateway.os_main.format_status_line_v1","app.gateway.os_main.handle_request_v1"]},{"body":["begin",["let","v",["std.vec.with_capacity",32]],["set","v",["std.vec.extend_bytes","v",["bytes.lit","HTTP/1.1 "]]],["set","v",["std.vec.extend_bytes","v",["std.fmt.u32_to_dec","status"]]],["set","v",["std.vec.extend_bytes","v",["bytes.lit"," OK\r\n"]]],["std.vec.as_bytes","v"]],"kind":"defn","name":"app.gateway.os_main.format_status_line_v1","params":[{"name":"status","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","norm_req",["app.gateway.core.normalize_request_v1","method","path","body"]],["let","route_res",["app.gateway.core.select_route_v1",["bytes.view","norm_req"]]],["let","not_found_msg",["bytes.lit","not_found"]],["if",["=",["result_bytes.is_ok","route_res"],0],["app.gateway.core.build_error_response_v1",404,["bytes.view","not_found_msg"]],["begin",["let","route",["result_bytes.unwrap_or","route_res",["bytes.alloc",0]]],["app.gateway.core.shape_response_v1",200,["bytes.view","route"]]]]],"kind":"defn","name":"app.gateway.os_main.handle_request_v1","params":[{"name":"method","ty":"bytes_view"},{"name":"path","ty":"bytes_view"},{"name":"body","ty":"bytes_view"}],"result":"bytes"}],"imports":["app.gateway.core","std.bytes","std.fmt","std.vec"],"kind":"module","module_id":"app.gateway.os_main","schema_version":"x07.x07ast@0.5.0"}
