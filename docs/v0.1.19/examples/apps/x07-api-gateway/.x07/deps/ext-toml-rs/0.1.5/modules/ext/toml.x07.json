{"decls":[{"kind":"export","names":["ext.toml.toml_get_bool","ext.toml.toml_get_i32","ext.toml.toml_get_string","ext.toml.toml_is_err","ext.toml.toml_parse"]},{"body":["begin",["let","n",["view.len","b"]],["if",["<u",["+","start",4],"n"],["if",["=",["view.get_u8","b","start"],102],["if",["=",["view.get_u8","b",["+","start",1]],97],["if",["=",["view.get_u8","b",["+","start",2]],108],["if",["=",["view.get_u8","b",["+","start",3]],115],["if",["=",["view.get_u8","b",["+","start",4]],101],["return",1],0],0],0],0],0],0],0],"kind":"defn","name":"ext.toml._check_bool_false","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["if",["<u",["+","start",3],"n"],["if",["=",["view.get_u8","b","start"],116],["if",["=",["view.get_u8","b",["+","start",1]],114],["if",["=",["view.get_u8","b",["+","start",2]],117],["if",["=",["view.get_u8","b",["+","start",3]],101],["return",1],0],0],0],0],0],0],"kind":"defn","name":"ext.toml._check_bool_true","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["let","i","start"],["let","found",["-",0,1]],["for","_","start","n",["if",["<u","i","n"],["if",["<","found",0],["begin",["let","c",["view.get_u8","b","i"]],["if",["=","c",10],["set","found","i"],0],["set","i",["+","i",1]]],0],0]],["if",["<","found",0],"n","found"]],"kind":"defn","name":"ext.toml._find_newline","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["if",[">=u","start","n"],["return","start"],0],["let","first",["view.get_u8","b","start"]],["if",["=",["=","first",34],0],["return","start"],0],["let","i",["+","start",1]],["let","found_end",["-",0,1]],["for","_",["+","start",1],"n",["if",["<u","i","n"],["if",["<","found_end",0],["begin",["let","c",["view.get_u8","b","i"]],["if",["=","c",34],["set","found_end",["+","i",1]],["if",["=","c",92],["set","i",["+","i",2]],["set","i",["+","i",1]]]]],0],0]],["if",["<","found_end",0],"n","found_end"]],"kind":"defn","name":"ext.toml._find_quote_end","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"i32"},{"body":["begin",["if",[">=u","c",65],["if",["<u","c",91],["return",1],0],0],["if",[">=u","c",97],["if",["<u","c",123],["return",1],0],0],0],"kind":"defn","name":"ext.toml._is_alpha","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["if",[">=u","c",48],["if",["<u","c",58],["return",1],0],0],0],"kind":"defn","name":"ext.toml._is_digit","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["if",["ext.toml._is_alpha","c"],["return",1],0],["if",["ext.toml._is_digit","c"],["return",1],0],["if",["if",["=","c",95],1,["=","c",45]],["return",1],0],0],"kind":"defn","name":"ext.toml._is_key_char","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["if",["=","c",32],1,["=","c",9]],"kind":"defn","name":"ext.toml._is_whitespace","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["let","msg_len",["view.len","msg"]],["let","out",["vec_u8.with_capacity",["+",9,"msg_len"]]],["set","out",["vec_u8.push","out",0]],["set","out",["ext.toml._push_u32_le","out","code"]],["set","out",["ext.toml._push_u32_le","out","msg_len"]],["for","i",0,"msg_len",["set","out",["vec_u8.push","out",["view.get_u8","msg","i"]]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.toml._make_error","params":[{"name":"code","ty":"i32"},{"name":"msg","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","i","start"],["let","neg",0],["if",["<u","i","line_end"],["begin",["let","c",["view.get_u8","b","i"]],["if",["=","c",45],["begin",["set","neg",1],["set","i",["+","i",1]]],["if",["=","c",43],["set","i",["+","i",1]],0]]],0],["let","val",0],["for","_","i","line_end",["if",["<u","i","line_end"],["begin",["let","c",["view.get_u8","b","i"]],["if",["ext.toml._is_digit","c"],["begin",["set","val",["+",["*","val",10],["-","c",48]]],["set","i",["+","i",1]]],0]],0]],["if",["=","neg",1],["-",0,"val"],"val"]],"kind":"defn","name":"ext.toml._parse_integer","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"line_end","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["let","i","start"],["for","_","start","n",["if",["<u","i","n"],["begin",["let","c",["view.get_u8","b","i"]],["if",["ext.toml._is_key_char","c"],["set","i",["+","i",1]],0]],0]],"i"],"kind":"defn","name":"ext.toml._parse_key","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["if",[">=u","start","n"],["return",["vec_u8.into_bytes",["vec_u8.with_capacity",0]]],0],["let","first",["view.get_u8","b","start"]],["if",["=",["=","first",34],0],["return",["vec_u8.into_bytes",["vec_u8.with_capacity",0]]],0],["let","out",["vec_u8.with_capacity",64]],["let","i",["+","start",1]],["let","found_end",0],["for","_",["+","start",1],"n",["if",["<u","i","n"],["if",["=","found_end",0],["begin",["let","c",["view.get_u8","b","i"]],["if",["=","c",34],["set","found_end",1],["if",["=","c",92],["if",["<u",["+","i",1],"n"],["begin",["let","next",["view.get_u8","b",["+","i",1]]],["if",["=","next",110],["set","out",["vec_u8.push","out",10]],["if",["=","next",116],["set","out",["vec_u8.push","out",9]],["if",["=","next",114],["set","out",["vec_u8.push","out",13]],["if",["=","next",92],["set","out",["vec_u8.push","out",92]],["if",["=","next",34],["set","out",["vec_u8.push","out",34]],["set","out",["vec_u8.push","out","next"]]]]]]],["set","i",["+","i",2]]],["set","i",["+","i",1]]],["begin",["set","out",["vec_u8.push","out","c"]],["set","i",["+","i",1]]]]]],0],0]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.toml._parse_quoted_string","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","o","out"],["set","o",["vec_u8.push","o",["&","val",255]]],["set","o",["vec_u8.push","o",["&",[">>u","val",8],255]]],["set","o",["vec_u8.push","o",["&",[">>u","val",16],255]]],["set","o",["vec_u8.push","o",["&",[">>u","val",24],255]]],"o"],"kind":"defn","name":"ext.toml._push_u32_le","params":[{"name":"out","ty":"vec_u8"},{"name":"val","ty":"i32"}],"result":"vec_u8"},{"body":["begin",["let","b0",["view.get_u8","b","offset"]],["let","b1",["view.get_u8","b",["+","offset",1]]],["let","b2",["view.get_u8","b",["+","offset",2]]],["let","b3",["view.get_u8","b",["+","offset",3]]],["+",["+",["+","b0",["<<u","b1",8]],["<<u","b2",16]],["<<u","b3",24]]],"kind":"defn","name":"ext.toml._read_u32_le","params":[{"name":"b","ty":"bytes_view"},{"name":"offset","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["let","i","start"],["for","_","start","n",["if",["<u","i","n"],["begin",["let","c",["view.get_u8","b","i"]],["if",["ext.toml._is_whitespace","c"],["set","i",["+","i",1]],0]],0]],"i"],"kind":"defn","name":"ext.toml._skip_whitespace","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","doc"]],["if",["<","n",5],["return",["-",0,1]],0],["let","tag",["view.get_u8","doc",0]],["if",["=",["=","tag",1],0],["return",["-",0,1]],0],["let","entry_count",["ext.toml._read_u32_le","doc",1]],["let","key_len",["view.len","key"]],["let","pos",5],["for","_",0,"entry_count",["if",["<u",["+","pos",4],"n"],["begin",["let","ek_len",["ext.toml._read_u32_le","doc","pos"]],["set","pos",["+","pos",4]],["if",["<u",["+","pos","ek_len"],"n"],["begin",["let","match_flag",1],["if",["=",["=","ek_len","key_len"],0],["set","match_flag",0],0],["if",["=","match_flag",1],["for","j",0,"ek_len",["if",["=",["=",["view.get_u8","doc",["+","pos","j"]],["view.get_u8","key","j"]],0],["set","match_flag",0],0]],0],["set","pos",["+","pos","ek_len"]],["if",["<u","pos","n"],["begin",["let","vtype",["view.get_u8","doc","pos"]],["set","pos",["+","pos",1]],["if",["=","vtype",1],["if",["<u",["+","pos",4],"n"],["begin",["let","vlen",["ext.toml._read_u32_le","doc","pos"]],["set","pos",["+",["+","pos",4],"vlen"]]],0],["if",["=","vtype",2],["set","pos",["+","pos",4]],["if",["=","vtype",3],["begin",["if",["=","match_flag",1],["return",["view.get_u8","doc","pos"]],0],["set","pos",["+","pos",1]]],0]]]],0]],0]],0]],["-",0,1]],"kind":"defn","name":"ext.toml.toml_get_bool","params":[{"name":"doc","ty":"bytes_view"},{"name":"key","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","n",["view.len","doc"]],["if",["<","n",5],["return",0],0],["let","tag",["view.get_u8","doc",0]],["if",["=",["=","tag",1],0],["return",0],0],["let","entry_count",["ext.toml._read_u32_le","doc",1]],["let","key_len",["view.len","key"]],["let","pos",5],["for","_",0,"entry_count",["if",["<u",["+","pos",4],"n"],["begin",["let","ek_len",["ext.toml._read_u32_le","doc","pos"]],["set","pos",["+","pos",4]],["if",["<u",["+","pos","ek_len"],"n"],["begin",["let","match_flag",1],["if",["=",["=","ek_len","key_len"],0],["set","match_flag",0],0],["if",["=","match_flag",1],["for","j",0,"ek_len",["if",["=",["=",["view.get_u8","doc",["+","pos","j"]],["view.get_u8","key","j"]],0],["set","match_flag",0],0]],0],["set","pos",["+","pos","ek_len"]],["if",["<u","pos","n"],["begin",["let","vtype",["view.get_u8","doc","pos"]],["set","pos",["+","pos",1]],["if",["=","vtype",1],["if",["<u",["+","pos",4],"n"],["begin",["let","vlen",["ext.toml._read_u32_le","doc","pos"]],["set","pos",["+",["+","pos",4],"vlen"]]],0],["if",["=","vtype",2],["begin",["if",["=","match_flag",1],["return",["ext.toml._read_u32_le","doc","pos"]],0],["set","pos",["+","pos",4]]],["if",["=","vtype",3],["set","pos",["+","pos",1]],0]]]],0]],0]],0]],0],"kind":"defn","name":"ext.toml.toml_get_i32","params":[{"name":"doc","ty":"bytes_view"},{"name":"key","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","n",["view.len","doc"]],["if",["<","n",5],["return",["vec_u8.into_bytes",["vec_u8.with_capacity",0]]],0],["let","tag",["view.get_u8","doc",0]],["if",["=",["=","tag",1],0],["return",["vec_u8.into_bytes",["vec_u8.with_capacity",0]]],0],["let","entry_count",["ext.toml._read_u32_le","doc",1]],["let","key_len",["view.len","key"]],["let","pos",5],["for","_",0,"entry_count",["if",["<u",["+","pos",4],"n"],["begin",["let","ek_len",["ext.toml._read_u32_le","doc","pos"]],["set","pos",["+","pos",4]],["if",["<u",["+","pos","ek_len"],"n"],["begin",["let","match_flag",1],["if",["=",["=","ek_len","key_len"],0],["set","match_flag",0],0],["if",["=","match_flag",1],["for","j",0,"ek_len",["if",["=",["=",["view.get_u8","doc",["+","pos","j"]],["view.get_u8","key","j"]],0],["set","match_flag",0],0]],0],["set","pos",["+","pos","ek_len"]],["if",["<u","pos","n"],["begin",["let","vtype",["view.get_u8","doc","pos"]],["set","pos",["+","pos",1]],["if",["=","vtype",1],["if",["<u",["+","pos",4],"n"],["begin",["let","vlen",["ext.toml._read_u32_le","doc","pos"]],["set","pos",["+","pos",4]],["if",["=","match_flag",1],["begin",["let","out",["vec_u8.with_capacity","vlen"]],["for","j",0,"vlen",["set","out",["vec_u8.push","out",["view.get_u8","doc",["+","pos","j"]]]]],["return",["vec_u8.into_bytes","out"]]],0],["set","pos",["+","pos","vlen"]]],0],["if",["=","vtype",2],["set","pos",["+","pos",4]],["if",["=","vtype",3],["set","pos",["+","pos",1]],0]]]],0]],0]],0]],["vec_u8.into_bytes",["vec_u8.with_capacity",0]]],"kind":"defn","name":"ext.toml.toml_get_string","params":[{"name":"doc","ty":"bytes_view"},{"name":"key","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["<",["view.len","doc"],1],["return",1],0],["=",["view.get_u8","doc",0],0]],"kind":"defn","name":"ext.toml.toml_is_err","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","n",["view.len","src"]],["let","out",["vec_u8.with_capacity",256]],["set","out",["vec_u8.push","out",1]],["let","count_pos",1],["set","out",["ext.toml._push_u32_le","out",0]],["let","section",["vec_u8.with_capacity",64]],["let","entry_count",0],["let","pos",0],["let","error_flag",0],["for","_",0,"n",["if",["<u","pos","n"],["if",["=","error_flag",0],["begin",["let","line_start","pos"],["let","line_end",["ext.toml._find_newline","src","pos"]],["set","pos",["+","line_end",1]],["let","trimmed_start",["ext.toml._skip_whitespace","src","line_start"]],["if",["<u","trimmed_start","line_end"],["begin",["let","first_char",["view.get_u8","src","trimmed_start"]],["if",["=","first_char",35],0,["if",["=","first_char",91],["begin",["let","section_start",["+","trimmed_start",1]],["let","section_end","section_start"],["for","j","section_start","line_end",["if",["<u","j","line_end"],["begin",["let","c",["view.get_u8","src","j"]],["if",["=","c",93],0,["if",["if",["ext.toml._is_key_char","c"],1,["=","c",46]],["set","section_end",["+","j",1]],0]]],0]],["set","section",["vec_u8.with_capacity",["+",["-","section_end","section_start"],1]]],["for","j","section_start","section_end",["set","section",["vec_u8.push","section",["view.get_u8","src","j"]]]],["set","section",["vec_u8.push","section",46]],0],["if",["ext.toml._is_key_char","first_char"],["begin",["let","key_start","trimmed_start"],["let","key_end",["ext.toml._parse_key","src","key_start"]],["let","after_key",["ext.toml._skip_whitespace","src","key_end"]],["if",["<u","after_key","line_end"],["begin",["let","eq_char",["view.get_u8","src","after_key"]],["if",["=","eq_char",61],["begin",["let","value_start",["ext.toml._skip_whitespace","src",["+","after_key",1]]],["if",["<u","value_start","line_end"],["begin",["let","value_char",["view.get_u8","src","value_start"]],["let","sec_view",["vec_u8.as_view","section"]],["let","sec_len",["view.len","sec_view"]],["let","key_len",["-","key_end","key_start"]],["let","full_key_len",["+","sec_len","key_len"]],["set","out",["ext.toml._push_u32_le","out","full_key_len"]],["for","j",0,"sec_len",["set","out",["vec_u8.push","out",["view.get_u8","sec_view","j"]]]],["for","j","key_start","key_end",["set","out",["vec_u8.push","out",["view.get_u8","src","j"]]]],["if",["=","value_char",34],["begin",["let","str_val",["ext.toml._parse_quoted_string","src","value_start"]],["let","str_view",["bytes.view","str_val"]],["let","str_len",["view.len","str_view"]],["set","out",["vec_u8.push","out",1]],["set","out",["ext.toml._push_u32_le","out","str_len"]],["for","j",0,"str_len",["set","out",["vec_u8.push","out",["view.get_u8","str_view","j"]]]],["set","entry_count",["+","entry_count",1]]],["if",["if",["if",["ext.toml._is_digit","value_char"],1,["=","value_char",45]],1,["=","value_char",43]],["begin",["let","int_val",["ext.toml._parse_integer","src","value_start","line_end"]],["set","out",["vec_u8.push","out",2]],["set","out",["ext.toml._push_u32_le","out","int_val"]],["set","entry_count",["+","entry_count",1]]],["if",["ext.toml._check_bool_true","src","value_start"],["begin",["set","out",["vec_u8.push","out",3]],["set","out",["vec_u8.push","out",1]],["set","entry_count",["+","entry_count",1]]],["if",["ext.toml._check_bool_false","src","value_start"],["begin",["set","out",["vec_u8.push","out",3]],["set","out",["vec_u8.push","out",0]],["set","entry_count",["+","entry_count",1]]],0]]]]],0]],0]],0]],0]]]],0]],0],0]],["let","final_bytes",["vec_u8.into_bytes","out"]],["let","final_view",["bytes.view","final_bytes"]],["let","final_len",["view.len","final_view"]],["let","result",["vec_u8.with_capacity","final_len"]],["set","result",["vec_u8.push","result",1]],["set","result",["ext.toml._push_u32_le","result","entry_count"]],["for","i",5,"final_len",["set","result",["vec_u8.push","result",["view.get_u8","final_view","i"]]]],["vec_u8.into_bytes","result"]],"kind":"defn","name":"ext.toml.toml_parse","params":[{"name":"src","ty":"bytes_view"}],"result":"bytes"}],"imports":[],"kind":"module","meta":{"generated_by":"x07import","source_path":"tests/x07import/fixtures/import_sources/rust/ext_toml@0.1.0/toml.rs","source_sha256":"838ab1ddf9d20a90fc60aa0e5410e6ef52cc79b816512b5a7daebaaf84990c67"},"module_id":"ext.toml","schema_version":"x07.x07ast@0.3.0"}
