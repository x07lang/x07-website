{"decls":[{"kind":"export","names":["test_rr.replay_fetch_example","test_rr.replay_extract_title","test_rr.replay_plan_and_fetch"]},{"body":["begin",["std.rr.with_policy_v1",["bytes.lit","crawl_rr_v1"],["bytes.lit","crawl_v1.rrbin"],["i32.lit",2],["begin",["let","h",["std.rr.current_v1"]],["if",["<=","h",0],["return",["std.test.fail",1]],0],["let","kind",["bytes.lit","rr"]],["let","op",["bytes.lit","std.crawl.fetch.http_get_v1"]],["let","key",["bytes.lit","https://example.com/"]],["let","next",["std.rr.next_v1","h",["bytes.view","kind"],["bytes.view","op"],["bytes.view","key"]]],["let","err_code",["result_bytes.err_code","next"]],["try",["std.test.assert_i32_eq","err_code",0,["std.test.code_assert_i32_eq"]]],["let","entry",["result_bytes.unwrap_or","next",["bytes.alloc",0]]],["let","resp",["std.rr.entry_resp_v1",["bytes.view","entry"]]],["try",["std.test.assert_true",[">",["view.len",["bytes.view","resp"]],0],["std.test.code_assert_true"]]],["std.test.pass"]]]],"kind":"defn","name":"test_rr.replay_fetch_example","params":[],"result":"result_i32"},{"body":["begin",["std.rr.with_policy_v1",["bytes.lit","crawl_rr_v1"],["bytes.lit","crawl_v1.rrbin"],["i32.lit",2],["begin",["let","h",["std.rr.current_v1"]],["if",["<=","h",0],["return",["std.test.fail",1]],0],["let","kind",["bytes.lit","rr"]],["let","op",["bytes.lit","std.crawl.fetch.http_get_v1"]],["let","key",["bytes.lit","https://example.com/"]],["let","next",["std.rr.next_v1","h",["bytes.view","kind"],["bytes.view","op"],["bytes.view","key"]]],["let","err_code",["result_bytes.err_code","next"]],["try",["std.test.assert_i32_eq","err_code",0,["std.test.code_assert_i32_eq"]]],["let","entry",["result_bytes.unwrap_or","next",["bytes.alloc",0]]],["let","html",["std.rr.entry_resp_v1",["bytes.view","entry"]]],["let","url",["bytes.lit","https://example.com/"]],["let","origin",["bytes.lit","https://example.com"]],["let","record",["app.extract.extract_records_v1",["bytes.view","html"],["bytes.view","url"],["bytes.view","origin"]]],["try",["std.test.assert_true",[">",["view.len",["bytes.view","record"]],10],["std.test.code_assert_true"]]],["std.test.pass"]]]],"kind":"defn","name":"test_rr.replay_extract_title","params":[],"result":"result_i32"},{"body":["begin",["let","seeds",["bytes.lit","https://example.com/"]],["let","robots",["bytes.lit",""]],["let","ua",["bytes.lit","x07crawl"]],["let","plan",["app.crawl.plan.plan_crawl_v1",["bytes.view","seeds"],["bytes.view","robots"],["bytes.view","ua"],10]],["try",["std.test.assert_true",[">",["view.len",["bytes.view","plan"]],0],["std.test.code_assert_true"]]],["std.rr.with_policy_v1",["bytes.lit","crawl_rr_v1"],["bytes.lit","crawl_v1.rrbin"],["i32.lit",2],["begin",["let","h",["std.rr.current_v1"]],["if",["<=","h",0],["return",["std.test.fail",2]],0],["let","kind",["bytes.lit","rr"]],["let","op",["bytes.lit","std.crawl.fetch.http_get_v1"]],["let","key",["bytes.lit","https://example.com/"]],["let","next",["std.rr.next_v1","h",["bytes.view","kind"],["bytes.view","op"],["bytes.view","key"]]],["let","err_code",["result_bytes.err_code","next"]],["try",["std.test.assert_i32_eq","err_code",0,["std.test.code_assert_i32_eq"]]],["let","entry",["result_bytes.unwrap_or","next",["bytes.alloc",0]]],["let","html",["std.rr.entry_resp_v1",["bytes.view","entry"]]],["let","url",["bytes.lit","https://example.com/"]],["let","origin",["bytes.lit","https://example.com"]],["let","record",["app.extract.extract_records_v1",["bytes.view","html"],["bytes.view","url"],["bytes.view","origin"]]],["let","canon",["app.extract.emit_canonical_json_v1",["bytes.view","record"]]],["try",["std.test.assert_true",[">",["view.len",["bytes.view","canon"]],10],["std.test.code_assert_true"]]],["std.test.pass"]]]],"kind":"defn","name":"test_rr.replay_plan_and_fetch","params":[],"result":"result_i32"}],"imports":["app.crawl.plan","app.extract","ext.json.canon","std.bytes","std.rr","std.test","std.vec"],"kind":"module","module_id":"test_rr","schema_version":"x07.x07ast@0.5.0"}
