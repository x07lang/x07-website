{"decls":[{"kind":"export","names":["ext.ini.data_model.parse"]},{"body":["ext.data_model.doc_err_from_msg","msg"],"kind":"defn","name":"ext.ini.data_model._err","params":[{"name":"msg","ty":"bytes_view"}],"result":"bytes"},{"body":["ext.ini.data_model._extend_view_range","v","b",0,["view.len","b"]],"kind":"defn","name":"ext.ini.data_model._extend_view","params":[{"name":"v","ty":"vec_u8"},{"name":"b","ty":"bytes_view"}],"result":"vec_u8"},{"body":["begin",["let","out","v"],["let","end",["+","start","len"]],["for","i","start","end",["begin",["set","out",["vec_u8.push","out",["view.get_u8","b","i"]]],0]],"out"],"kind":"defn","name":"ext.ini.data_model._extend_view_range","params":[{"name":"v","ty":"vec_u8"},{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"len","ty":"i32"}],"result":"vec_u8"},{"body":["begin",["let","msg_bad_section",["bytes.lit","ini:bad_section"]],["let","msg_bad_entry",["bytes.lit","ini:bad_entry"]],["let","msg_bad_quoted_value",["bytes.lit","ini:bad_quoted_value"]],["let","msg_dup_key",["bytes.lit","ini:dup_key"]],["let","msg_malformed",["bytes.lit","ini:malformed_doc"]],["let","msg_decode_failed",["bytes.lit","ini:decode_failed"]],["let","msg_dup_keys",["bytes.lit","ini:dup_keys"]],["let","raw",["ext.ini.ini_parse","src"]],["let","rawv",["bytes.view","raw"]],["if",["=",["ext.ini.ini_is_err","rawv"],1],["begin",["let","code",["ext.data_model.doc_error_code","rawv"]],["if",["=","code",1],["return",["ext.ini.data_model._err",["bytes.view","msg_bad_section"]]],0],["if",["=","code",2],["return",["ext.ini.data_model._err",["bytes.view","msg_bad_entry"]]],0],["if",["=","code",3],["return",["ext.ini.data_model._err",["bytes.view","msg_bad_quoted_value"]]],0],["if",["=","code",4],["return",["ext.ini.data_model._err",["bytes.view","msg_dup_key"]]],0],["return",["ext.data_model.doc_err_from_code","code"]]],0],["let","n",["view.len","rawv"]],["if",["<","n",5],["return",["ext.ini.data_model._err",["bytes.view","msg_malformed"]]],0],["let","count",["codec.read_u32_le","rawv",1]],["let","entries",["vec_u8.with_capacity",["+",4,"n"]]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le","count"]]],["let","pos",5],["let","ok",1],["for","_",0,"count",["begin",["if",["=","ok",0],0,["begin",["if",[">=u",["+","pos",4],["+","n",1]],["set","ok",0],0],["if",["=","ok",0],0,["begin",["let","key_len",["codec.read_u32_le","rawv","pos"]],["set","pos",["+","pos",4]],["if",[">=u",["+","pos","key_len"],["+","n",1]],["set","ok",0],0],["if",["=","ok",0],0,["begin",["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le","key_len"]]],["set","entries",["ext.ini.data_model._extend_view_range","entries","rawv","pos","key_len"]],["set","pos",["+","pos","key_len"]],["if",[">=u",["+","pos",4],["+","n",1]],["set","ok",0],0],["if",["=","ok",0],0,["begin",["let","vlen",["codec.read_u32_le","rawv","pos"]],["set","pos",["+","pos",4]],["if",[">=u",["+","pos","vlen"],["+","n",1]],["set","ok",0],0],["if",["=","ok",0],0,["begin",["let","s",["view.slice","rawv","pos","vlen"]],["let","val",["ext.data_model.value_string","s"]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["bytes.len","val"]]]],["set","entries",["ext.ini.data_model._extend_view","entries",["bytes.view","val"]]],["set","pos",["+","pos","vlen"]],0]]]],0]]]],0]],0]],["if",["=","ok",0],["return",["ext.ini.data_model._err",["bytes.view","msg_decode_failed"]]],0],["let","entries_b",["vec_u8.into_bytes","entries"]],["let","map_val",["ext.data_model.value_map_from_entries",["bytes.view","entries_b"]]],["if",["=",["bytes.len","map_val"],0],["return",["ext.ini.data_model._err",["bytes.view","msg_dup_keys"]]],0],["ext.data_model.doc_ok",["bytes.view","map_val"]]],"kind":"defn","name":"ext.ini.data_model.parse","params":[{"name":"src","ty":"bytes_view"}],"result":"bytes"}],"imports":["ext.data_model","ext.ini"],"kind":"module","module_id":"ext.ini.data_model","schema_version":"x07.x07ast@0.3.0"}
