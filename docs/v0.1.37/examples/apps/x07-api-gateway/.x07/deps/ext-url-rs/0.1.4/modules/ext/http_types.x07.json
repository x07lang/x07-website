{"decls":[{"kind":"export","names":["ext.http_types.build_request","ext.http_types.build_response","ext.http_types.header_line","ext.http_types.lowercase_ascii"]},{"body":["begin",["set","out",["vec_u8.push","out",13]],["set","out",["vec_u8.push","out",10]],"out"],"kind":"defn","name":"ext.http_types._append_crlf","params":[{"name":"out","ty":"vec_u8"}],"result":"vec_u8"},{"body":["begin",["set","out",["vec_u8.push","out",72]],["set","out",["vec_u8.push","out",84]],["set","out",["vec_u8.push","out",84]],["set","out",["vec_u8.push","out",80]],["set","out",["vec_u8.push","out",47]],["set","out",["vec_u8.push","out",49]],["set","out",["vec_u8.push","out",46]],["set","out",["vec_u8.push","out",49]],"out"],"kind":"defn","name":"ext.http_types._append_http_11","params":[{"name":"out","ty":"vec_u8"}],"result":"vec_u8"},{"body":["if",["ext.http_types._is_upper_ascii","c"],["+","c",32],"c"],"kind":"defn","name":"ext.http_types._ascii_lower","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["if",["<u","n",2],["return",0],0],["if",["=",["view.get_u8","b",["-","n",2]],13],["=",["view.get_u8","b",["-","n",1]],10],0]],"kind":"defn","name":"ext.http_types._ends_with_crlf","params":[{"name":"b","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","n",["view.len","b"]],["if",["<u","n",4],["return",0],0],["if",["if",["if",["=",["view.get_u8","b",["-","n",4]],13],["=",["view.get_u8","b",["-","n",3]],10],0],["=",["view.get_u8","b",["-","n",2]],13],0],["=",["view.get_u8","b",["-","n",1]],10],0]],"kind":"defn","name":"ext.http_types._ends_with_crlfcrlf","params":[{"name":"b","ty":"bytes_view"}],"result":"i32"},{"body":["if",[">=u","c",65],["<u","c",91],0],"kind":"defn","name":"ext.http_types._is_upper_ascii","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["let","method_len",["view.len","method"]],["let","target_len",["view.len","target"]],["let","headers_len",["view.len","headers"]],["let","body_len",["view.len","body"]],["let","out",["vec_u8.with_capacity",["+",["+",["+",["+","method_len","target_len"],"headers_len"],"body_len"],32]]],["set","out",["vec_u8.extend_bytes","out","method"]],["set","out",["vec_u8.push","out",32]],["set","out",["vec_u8.extend_bytes","out","target"]],["set","out",["vec_u8.push","out",32]],["set","out",["ext.http_types._append_http_11","out"]],["set","out",["ext.http_types._append_crlf","out"]],["set","out",["vec_u8.extend_bytes","out","headers"]],["if",["=","headers_len",0],["begin",["set","out",["ext.http_types._append_crlf","out"]],0],["if",["ext.http_types._ends_with_crlfcrlf","headers"],0,["if",["ext.http_types._ends_with_crlf","headers"],["begin",["set","out",["ext.http_types._append_crlf","out"]],0],["begin",["set","out",["ext.http_types._append_crlf","out"]],["set","out",["ext.http_types._append_crlf","out"]],0]]]],["set","out",["vec_u8.extend_bytes","out","body"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.http_types.build_request","params":[{"name":"method","ty":"bytes_view"},{"name":"target","ty":"bytes_view"},{"name":"headers","ty":"bytes_view"},{"name":"body","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","status_b",["fmt.u32_to_dec","status"]],["let","status_v",["bytes.view","status_b"]],["let","reason_len",["view.len","reason"]],["let","headers_len",["view.len","headers"]],["let","body_len",["view.len","body"]],["let","out",["vec_u8.with_capacity",["+",["+",["+","reason_len","headers_len"],"body_len"],48]]],["set","out",["ext.http_types._append_http_11","out"]],["set","out",["vec_u8.push","out",32]],["set","out",["vec_u8.extend_bytes","out","status_v"]],["set","out",["vec_u8.push","out",32]],["set","out",["vec_u8.extend_bytes","out","reason"]],["set","out",["ext.http_types._append_crlf","out"]],["set","out",["vec_u8.extend_bytes","out","headers"]],["if",["=","headers_len",0],["begin",["set","out",["ext.http_types._append_crlf","out"]],0],["if",["ext.http_types._ends_with_crlfcrlf","headers"],0,["if",["ext.http_types._ends_with_crlf","headers"],["begin",["set","out",["ext.http_types._append_crlf","out"]],0],["begin",["set","out",["ext.http_types._append_crlf","out"]],["set","out",["ext.http_types._append_crlf","out"]],0]]]],["set","out",["vec_u8.extend_bytes","out","body"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.http_types.build_response","params":[{"name":"status","ty":"i32"},{"name":"reason","ty":"bytes_view"},{"name":"headers","ty":"bytes_view"},{"name":"body","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","n_len",["view.len","name"]],["let","v_len",["view.len","value"]],["let","out",["vec_u8.with_capacity",["+",["+","n_len","v_len"],4]]],["set","out",["vec_u8.extend_bytes","out","name"]],["set","out",["vec_u8.push","out",58]],["set","out",["vec_u8.push","out",32]],["set","out",["vec_u8.extend_bytes","out","value"]],["set","out",["ext.http_types._append_crlf","out"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.http_types.header_line","params":[{"name":"name","ty":"bytes_view"},{"name":"value","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","b"]],["let","out",["vec_u8.with_capacity","n"]],["for","i",0,"n",["begin",["let","c",["view.get_u8","b","i"]],["set","out",["vec_u8.push","out",["ext.http_types._ascii_lower","c"]]]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.http_types.lowercase_ascii","params":[{"name":"b","ty":"bytes_view"}],"result":"bytes"}],"imports":[],"kind":"module","meta":{"generated_by":"x07import","source_path":"tests/x07import/fixtures/import_sources/rust/ext_url@0.1.0/http_types.rs","source_sha256":"9f650494ab231cbbdc5e5b682dd8f56348eef406e40558a75222e852ed964eb3"},"module_id":"ext.http_types","schema_version":"x07.x07ast@0.3.0"}
