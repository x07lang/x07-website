{
  "env": { "allow_keys": ["PORT", "HOST", "LOG_LEVEL"], "deny_keys": [], "enabled": true },
  "fs": {
    "allow_glob": true,
    "allow_mkdir": true,
    "allow_remove": false,
    "allow_rename": true,
    "allow_symlinks": false,
    "allow_walk": true,
    "deny_hidden": true,
    "enabled": true,
    "max_depth": 64,
    "max_entries": 50000,
    "max_read_bytes": 67108864,
    "max_write_bytes": 134217728,
    "read_roots": ["."],
    "write_roots": ["out"]
  },
  "language": { "allow_ffi": true, "allow_unsafe": true },
  "limits": {
    "core_dumps": false,
    "cpu_ms": 180000,
    "fds": 512,
    "mem_bytes": 1073741824,
    "procs": 64,
    "wall_ms": 600000
  },
  "net": { "allow_dns": true, "allow_hosts": [], "allow_tcp": true, "allow_udp": false, "enabled": true },
  "notes": "Sandbox policy for x07-api-gateway. net.allow_hosts is intentionally empty; allow bind/connect targets via x07 run --allow-host.",
  "policy_id": "sandbox.x07-api-gateway.base",
  "process": {
    "allow_args_regex_lite": [],
    "allow_cwd": false,
    "allow_cwd_roots": [],
    "allow_env_keys": [],
    "allow_exec": false,
    "allow_exec_prefixes": [],
    "allow_execs": [],
    "allow_exit": true,
    "allow_spawn": false,
    "enabled": true,
    "kill_on_drop": true,
    "kill_tree": true,
    "max_arg_bytes": 4096,
    "max_args": 64,
    "max_env": 64,
    "max_env_key_bytes": 256,
    "max_env_val_bytes": 4096,
    "max_exe_bytes": 4096,
    "max_live": 0,
    "max_runtime_ms": 0,
    "max_spawns": 0,
    "max_stderr_bytes": 10485760,
    "max_stdin_bytes": 1048576,
    "max_stdout_bytes": 10485760,
    "max_total_bytes": 16777216
  },
  "schema_version": "x07.run-os-policy@0.1.0",
  "threads": { "enabled": true, "max_blocking": 4, "max_queue": 1024, "max_workers": 0 },
  "time": {
    "allow_local_tzid": false,
    "allow_monotonic": true,
    "allow_sleep": true,
    "allow_wall_clock": true,
    "enabled": true,
    "max_sleep_ms": 1000
  }
}
